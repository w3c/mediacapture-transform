<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>MediaStreamTrack Insertable Media Processing using Streams</title>
  <meta content="ED" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED" rel="stylesheet">
  <meta content="Bikeshed version 82ce88815, updated Thu Sep 7 16:33:55 2023 -0700" name="generator">
  <link href="https://www.w3.org/TR/mediacapture-transform/" rel="canonical">
  <meta content="531b8091c876cbe309d5ace28785379db35335f3" name="document-revision">
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    white-space: pre;
    display: inline-block;
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled[role="button"] { cursor: pointer; }
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    white-space: pre;
    display: inline-block;
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled[role="button"] { cursor: pointer; }
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */

            pre.idl.highlight {
                background: var(--borderedblock-bg, var(--def-bg));
            }
            
</style>
<style>/* Boilerplate: style-syntax-highlighting */

code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */


@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">MediaStreamTrack Insertable Media Processing using Streams</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#ED">Editor’s Draft</a>, <time class="dt-updated" datetime="2024-05-31">31 May 2024</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="https://w3c.github.io/mediacapture-transform/">https://w3c.github.io/mediacapture-transform/</a>
      <dt>Latest published version:
      <dd><a href="https://www.w3.org/TR/mediacapture-transform/">https://www.w3.org/TR/mediacapture-transform/</a>
      <dt>Feedback:
      <dd><span><a href="mailto:public-webrtc@w3.org?subject=%5Bmediacapture-transform%5D%20YOUR%20TOPIC%20HERE">public-webrtc@w3.org</a> with subject line “<kbd>[mediacapture-transform] <i data-lt>… message topic …</i></kbd>” (<a href="https://lists.w3.org/Archives/Public/public-webrtc/" rel="discussion">archives</a>)</span>
      <dd><a href="https://github.com/w3c/mediacapture-transform/issues/">GitHub</a>
      <dt class="editor">Editors:
      <dd class="editor p-author h-card vcard" data-editor-id="24610"><a class="p-name fn u-email email" href="mailto:hta@google.com">Harald Alvestrand</a> (<a class="p-org org" href="https://google.com">Google</a>)
      <dd class="editor p-author h-card vcard" data-editor-id="84810"><a class="p-name fn u-email email" href="mailto:guidou@google.com">Guido Urdaneta</a> (<a class="p-org org" href="https://google.com">Google</a>)
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> © 2024 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/copyright/software-license/" rel="license" title="W3C Software and Document License">permissive document license</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This API defines an API surface for manipulating the bits on <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack">MediaStreamTrack</a></code>s carrying raw data.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress. </p>
   <p> If you wish to make comments regarding this document, please send them to <a href="mailto:public-webrtc@w3.org?Subject=%5Bmediacapture-transform%5D%20PUT%20SUBJECT%20HERE">public-webrtc@w3.org</a> (<a href="mailto:public-webrtc-request@w3.org?subject=subscribe">subscribe</a>, <a href="https://lists.w3.org/Archives/Public/public-webrtc/">archives</a>).
	When sending e-mail,
	please put the text “mediacapture-transform” in the subject,
	preferably like this:
	“[mediacapture-transform] <em>…summary of comment…</em>”.
	All comments are welcome. </p>
   <p> This document was produced by the <a href="https://www.w3.org/groups/wg/webrtc">Web Real-Time Communications Working Group</a>. </p>
   <p> This document was produced by a group operating under
	the <a href="https://www.w3.org/Consortium/Patent-Policy/">W3C Patent Policy</a>.
	W3C maintains a <a href="https://www.w3.org/2004/01/pp-impl/47318/status" rel="disclosure">public list of any patent disclosures</a> made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes contains <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">section 6 of the W3C Patent Policy</a>. </p>
   <p> This document is governed by the <a href="https://www.w3.org/2023/Process-20231103/" id="w3c_process_revision">03 November 2023 W3C Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#introduction"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li>
     <a href="#specification"><span class="secno">2</span> <span class="content">Specification</span></a>
     <ol class="toc">
      <li>
       <a href="#track-processor"><span class="secno">2.1</span> <span class="content">MediaStreamTrackProcessor</span></a>
       <ol class="toc">
        <li><a href="#track-processor-interface"><span class="secno">2.1.1</span> <span class="content">Interface definition</span></a>
        <li><a href="#internal-slots-processor"><span class="secno">2.1.2</span> <span class="content">Internal slots</span></a>
        <li><a href="#constructor-processor"><span class="secno">2.1.3</span> <span class="content">Constructor</span></a>
        <li><a href="#attributes-processor"><span class="secno">2.1.4</span> <span class="content">Attributes</span></a>
        <li><a href="#processor-handling-interaction-with-track"><span class="secno">2.1.5</span> <span class="content">Handling interaction with the track</span></a>
       </ol>
      <li>
       <a href="#video-track-generator"><span class="secno">2.2</span> <span class="content">VideoTrackGenerator</span></a>
       <ol class="toc">
        <li><a href="#video-generator-interface"><span class="secno">2.2.1</span> <span class="content">Interface definition</span></a>
        <li><a href="#internal-slots"><span class="secno">2.2.2</span> <span class="content">Internal slots</span></a>
        <li><a href="#video-generator-constructor"><span class="secno">2.2.3</span> <span class="content">Constructor</span></a>
        <li><a href="#video-generator-attributes"><span class="secno">2.2.4</span> <span class="content">Attributes</span></a>
        <li>
         <a href="#video-generator-as-track"><span class="secno">2.2.5</span> <span class="content">Specialization of MediaStreamTrack behavior</span></a>
         <ol class="toc">
          <li><a href="#video-generator-stop"><span class="secno">2.2.5.1</span> <span class="content">stop</span></a>
          <li><a href="#generator-constrainable-properties"><span class="secno">2.2.5.2</span> <span class="content">Constrainable properties</span></a>
          <li><a href="#generator-events-attributes"><span class="secno">2.2.5.3</span> <span class="content">Events and attributes</span></a>
         </ol>
       </ol>
     </ol>
    <li>
     <a href="#examples"><span class="secno">3</span> <span class="content">Examples</span></a>
     <ol class="toc">
      <li><a href="#video-processing"><span class="secno">3.1</span> <span class="content">Video Processing</span></a>
      <li><a href="#multi-consumer-constraints"><span class="secno">3.2</span> <span class="content">Multi-consumer post-processing with constraints</span></a>
      <li><a href="#multi-consumer-worker"><span class="secno">3.3</span> <span class="content">Multi-consumer post-processing with constraints in a worker</span></a>
     </ol>
    <li>
     <a href="#implementation-advice"><span class="secno">4</span> <span class="content">Implementation advice</span></a>
     <ol class="toc">
      <li><a href="#multi-consumers"><span class="secno">4.1</span> <span class="content">Use with multiple consumers</span></a>
     </ol>
    <li><a href="#security-considerations"><span class="secno">5</span> <span class="content">Security and Privacy considerations</span></a>
    <li><a href="#backwards-compatibility"><span class="secno">6</span> <span class="content">Backwards compatibility with earlier proposals</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction"></a></h2>
   <p>The <a data-link-type="biblio" href="#biblio-webrtc-nv-use-cases" title="WebRTC Extended Use Cases">[WEBRTC-NV-USE-CASES]</a> document describes several functions that
can only be achieved by access to media (requirements N20-N22),
including, but not limited to:</p>
   <ul>
    <li data-md>
     <p>Funny Hats</p>
    <li data-md>
     <p>Machine Learning</p>
    <li data-md>
     <p>Virtual Reality Gaming</p>
   </ul>
   <p>These use cases further require that processing can be done in worker
threads (requirement N23-N24).</p>
   <p>This specification gives an interface based on <a data-link-type="biblio" href="#biblio-webcodecs" title="WebCodecs">[WEBCODECS]</a> and <a data-link-type="biblio" href="#biblio-streams" title="Streams Standard">[STREAMS]</a> to
provide access to such functionality.</p>
   <p>This specification provides access to raw media,
which is the output of a media source such as a camera, microphone, screen capture,
or the decoder part of a codec and the input to the
decoder part of a codec. The processed media can be consumed by any destination
that can take a MediaStreamTrack, including HTML &lt;video> tags,
RTCPeerConnection, canvas or MediaRecorder.</p>
   <p>This specification explicitly aims to support the following use cases:</p>
   <ul>
    <li data-md>
     <p><em>Video processing</em>: This is the "Funny Hats" use case, where the input is a single video track and the output is a transformed video track.</p>
    <li data-md>
     <p><em>Custom video sink</em>: In this use case, the purpose is not producing a processed <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack①">MediaStreamTrack</a></code>, but to consume the media in a different way. For example, an application could use <a data-link-type="biblio" href="#biblio-webcodecs" title="WebCodecs">[WEBCODECS]</a> and <a data-link-type="biblio" href="#biblio-webtransport" title="WebTransport">[WEBTRANSPORT]</a> to create an <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcpeerconnection" id="ref-for-dom-rtcpeerconnection">RTCPeerConnection</a></code>-like sink, but using different codec configuration and networking protocols.</p>
    <li data-md>
     <p><em>Multi-source processing</em>: In this use case, two or more tracks are combined into one. For example, a presentation containing a live weather map and a camera track with the speaker can be combined to produce a weather report application.</p>
   </ul>
   <p class="note" role="note"><span class="marker">Note:</span> There is no WG consensus on whether or not audio use cases should be supported.</p>
   <p class="note" role="note"><span class="marker">Note:</span> The WG expects that the Streams spec will adopt the solutions outlined in <a href="https://github.com/whatwg/streams/blob/main/streams-for-raw-video-explainer.md">the relevant explainer</a>, to solve some issues with the current Streams specification.</p>
   <h2 class="heading settled" data-level="2" id="specification"><span class="secno">2. </span><span class="content">Specification</span><a class="self-link" href="#specification"></a></h2>
   <p>This specification shows the IDL extensions for <a data-link-type="biblio" href="#biblio-mediacapture-streams" title="Media Capture and Streams">[MEDIACAPTURE-STREAMS]</a>.
It defines some new objects that inherit the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack②">MediaStreamTrack</a></code> interface, and
can be constructed from a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack③">MediaStreamTrack</a></code>.</p>
   <p>The API consists of two elements. One is a track sink that is
capable of exposing the unencoded media frames from the track to a ReadableStream.
The other one is the inverse of that: it provides a track source that takes
media frames as input.</p>
   <h3 class="heading settled" data-level="2.1" id="track-processor"><span class="secno">2.1. </span><span class="content">MediaStreamTrackProcessor</span><a class="self-link" href="#track-processor"></a></h3>
   <p>A <code class="idl"><a data-link-type="idl" href="#mediastreamtrackprocessor" id="ref-for-mediastreamtrackprocessor">MediaStreamTrackProcessor</a></code> allows the creation of a <code class="idl"><a data-link-type="idl" href="https://streams.spec.whatwg.org/#readablestream" id="ref-for-readablestream">ReadableStream</a></code> that can expose the media flowing through
a given <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack④">MediaStreamTrack</a></code>. If the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack⑤">MediaStreamTrack</a></code> is a video track,
the chunks exposed by the stream will be <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webcodecs/#videoframe" id="ref-for-videoframe">VideoFrame</a></code> objects.</p>
   <p>This makes <code class="idl"><a data-link-type="idl" href="#mediastreamtrackprocessor" id="ref-for-mediastreamtrackprocessor①">MediaStreamTrackProcessor</a></code> effectively a sink in the <a href="https://www.w3.org/TR/mediacapture-streams/#the-model-sources-sinks-constraints-and-settings"> MediaStream model</a>.</p>
   <p>A <code class="idl"><a data-link-type="idl" href="#mediastreamtrackprocessor" id="ref-for-mediastreamtrackprocessor②">MediaStreamTrackProcessor</a></code> internally contains a circular queue
that allows buffering incoming media frames delivered by the track it
is connected to. This buffering allows the <code class="idl"><a data-link-type="idl" href="#mediastreamtrackprocessor" id="ref-for-mediastreamtrackprocessor③">MediaStreamTrackProcessor</a></code> to temporarily hold frames waiting to be read from its associated <code class="idl"><a data-link-type="idl" href="https://streams.spec.whatwg.org/#readablestream" id="ref-for-readablestream①">ReadableStream</a></code>.
The application can influence the maximum size of the queue via a parameter
provided in the <code class="idl"><a data-link-type="idl" href="#mediastreamtrackprocessor" id="ref-for-mediastreamtrackprocessor④">MediaStreamTrackProcessor</a></code> constructor. However, the
maximum size of the queue is decided by the UA and can change dynamically,
but it will not exceed the size requested by the application.
If the application does not provide a maximum size parameter, the UA is free
to decide the maximum size of the queue.</p>
   <p>When a new frame arrives to the <code class="idl"><a data-link-type="idl" href="#mediastreamtrackprocessor" id="ref-for-mediastreamtrackprocessor⑤">MediaStreamTrackProcessor</a></code>, if the queue has reached its maximum size,
the oldest frame will be removed from the queue, and the new frame will be
added to the queue. This means that for the particular case of a queue
with a maximum size of 1, if there is a queued frame, it will aways be
the most recent one.</p>
   <p>The UA is also free to remove any frames from the queue at any time. The UA
may remove frames in order to save resources or to improve performance in
specific situations. In all cases, frames that are not dropped
must be made available to the <code class="idl"><a data-link-type="idl" href="https://streams.spec.whatwg.org/#readablestream" id="ref-for-readablestream②">ReadableStream</a></code> in the order in which
they arrive to the <code class="idl"><a data-link-type="idl" href="#mediastreamtrackprocessor" id="ref-for-mediastreamtrackprocessor⑥">MediaStreamTrackProcessor</a></code>.</p>
   <p>A <code class="idl"><a data-link-type="idl" href="#mediastreamtrackprocessor" id="ref-for-mediastreamtrackprocessor⑦">MediaStreamTrackProcessor</a></code> makes frames available to its
associated <code class="idl"><a data-link-type="idl" href="https://streams.spec.whatwg.org/#readablestream" id="ref-for-readablestream③">ReadableStream</a></code> only when a read request has been issued on
the stream. The idea is to avoid the stream’s internal buffering, which
does not give the UA enough flexibility to choose the buffering policy.</p>
   <h4 class="heading settled" data-level="2.1.1" id="track-processor-interface"><span class="secno">2.1.1. </span><span class="content">Interface definition</span><a class="self-link" href="#track-processor-interface"></a></h4>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=<c- n>DedicatedWorker</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="mediastreamtrackprocessor"><code><c- g>MediaStreamTrackProcessor</c-></code></dfn> {
    <a class="idl-code" data-link-type="constructor" href="#dom-mediastreamtrackprocessor-mediastreamtrackprocessor" id="ref-for-dom-mediastreamtrackprocessor-mediastreamtrackprocessor"><c- g>constructor</c-></a>(<a data-link-type="idl-name" href="#dictdef-mediastreamtrackprocessorinit" id="ref-for-dictdef-mediastreamtrackprocessorinit"><c- n>MediaStreamTrackProcessorInit</c-></a> <dfn class="idl-code" data-dfn-for="MediaStreamTrackProcessor/MediaStreamTrackProcessor(init), MediaStreamTrackProcessor/constructor(init)" data-dfn-type="argument" data-export id="dom-mediastreamtrackprocessor-mediastreamtrackprocessor-init-init"><code><c- g>init</c-></code><a class="self-link" href="#dom-mediastreamtrackprocessor-mediastreamtrackprocessor-init-init"></a></dfn>);
    <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://streams.spec.whatwg.org/#readablestream" id="ref-for-readablestream④"><c- n>ReadableStream</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ReadableStream" href="#dom-mediastreamtrackprocessor-readable" id="ref-for-dom-mediastreamtrackprocessor-readable"><c- g>readable</c-></a>;
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-mediastreamtrackprocessorinit"><code><c- g>MediaStreamTrackProcessorInit</c-></code></dfn> {
  <c- b>required</c-> <a data-link-type="idl-name" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack⑥"><c- n>MediaStreamTrack</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MediaStreamTrackProcessorInit" data-dfn-type="dict-member" data-export data-type="MediaStreamTrack " id="dom-mediastreamtrackprocessorinit-track"><code><c- g>track</c-></code></dfn>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange" id="ref-for-EnforceRange"><c- g>EnforceRange</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short" id="ref-for-idl-unsigned-short"><c- b>unsigned</c-> <c- b>short</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="MediaStreamTrackProcessorInit" data-dfn-type="dict-member" data-export data-type="unsigned short " id="dom-mediastreamtrackprocessorinit-maxbuffersize"><code><c- g>maxBufferSize</c-></code></dfn>;
};
</pre>
   <p class="note" role="note"><span class="marker">Note:</span> There is WG consensus that the interface should be exposed on DedicatedWorker.
There is no WG consensus on whether or not the interface should not be exposed on Window.</p>
   <p class="note" role="note"><span class="marker">Note:</span> There is consensus in the WG that creating a MediaStreamTrackProcessor from a MediaStreamTrack of kind "video" should exist.
There is no WG consensus on whether or not creating a MediaStreamTrackProcessor from a MediaStreamTrack of kind "audio" should be supported.</p>
   <h4 class="heading settled" data-level="2.1.2" id="internal-slots-processor"><span class="secno">2.1.2. </span><span class="content">Internal slots</span><a class="self-link" href="#internal-slots-processor"></a></h4>
   <dl>
    <dt><dfn class="idl-code" data-dfn-for="MediaStreamTrackProcessor" data-dfn-type="attribute" data-export id="dom-mediastreamtrackprocessor-track-slot"><code>[[track]]</code><a class="self-link" href="#dom-mediastreamtrackprocessor-track-slot"></a></dfn>
    <dd>Track whose raw data is to be exposed by the <code class="idl"><a data-link-type="idl" href="#mediastreamtrackprocessor" id="ref-for-mediastreamtrackprocessor⑧">MediaStreamTrackProcessor</a></code>.
    <dt><dfn class="idl-code" data-dfn-for="MediaStreamTrackProcessor" data-dfn-type="attribute" data-export id="dom-mediastreamtrackprocessor-maxbuffersize-slot"><code>[[maxBufferSize]]</code><a class="self-link" href="#dom-mediastreamtrackprocessor-maxbuffersize-slot"></a></dfn>
    <dd>The maximum number of media frames to be buffered by the <code class="idl"><a data-link-type="idl" href="#mediastreamtrackprocessor" id="ref-for-mediastreamtrackprocessor⑨">MediaStreamTrackProcessor</a></code> as specified by the application. It may have no value if the application does
not provide it. Its minimum valid value is 1.
    <dt><dfn class="idl-code" data-dfn-for="MediaStreamTrackProcessor" data-dfn-type="attribute" data-export id="dom-mediastreamtrackprocessor-queue-slot"><code>[[queue]]</code><a class="self-link" href="#dom-mediastreamtrackprocessor-queue-slot"></a></dfn>
    <dd>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#queue" id="ref-for-queue">queue</a> used to buffer media frames not yet read by the application
    <dt><dfn class="idl-code" data-dfn-for="MediaStreamTrackProcessor" data-dfn-type="attribute" data-export id="dom-mediastreamtrackprocessor-numpendingreads-slot"><code>[[numPendingReads]]</code><a class="self-link" href="#dom-mediastreamtrackprocessor-numpendingreads-slot"></a></dfn>
    <dd>An integer whose value represents the number of read requests issued by the
application that have not yet been handled. 
    <dt><dfn class="idl-code" data-dfn-for="MediaStreamTrackProcessor" data-dfn-type="attribute" data-export id="dom-mediastreamtrackprocessor-isclosed-slot"><code>[[isClosed]]</code><a class="self-link" href="#dom-mediastreamtrackprocessor-isclosed-slot"></a></dfn>
    <dd>An boolean whose value indicates if the <code class="idl"><a data-link-type="idl" href="#mediastreamtrackprocessor" id="ref-for-mediastreamtrackprocessor①⓪">MediaStreamTrackProcessor</a></code> is closed. 
   </dl>
   <h4 class="heading settled" data-level="2.1.3" id="constructor-processor"><span class="secno">2.1.3. </span><span class="content">Constructor</span><a class="self-link" href="#constructor-processor"></a></h4>
    <dfn class="dfn-paneled idl-code" data-dfn-for="MediaStreamTrackProcessor" data-dfn-type="constructor" data-export data-lt="MediaStreamTrackProcessor(init)|constructor(init)" id="dom-mediastreamtrackprocessor-mediastreamtrackprocessor" title="MediaStreamTrackProcessor(init)"><code> MediaStreamTrackProcessor(<var>init</var>) </code></dfn> 
   <ol>
    <li data-md>
     <p>If <var>init</var>.<code class="idl"><a data-link-type="idl" href="#dom-mediastreamtrackprocessorinit-track" id="ref-for-dom-mediastreamtrackprocessorinit-track">track</a></code> is not a valid <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack⑦">MediaStreamTrack</a></code>,
throw a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror">TypeError</a></code>.</p>
    <li data-md>
     <p>Let <var>maxBufferSize</var> be 1.</p>
    <li data-md>
     <p>If <var>init</var>.<code class="idl"><a data-link-type="idl" href="#dom-mediastreamtrackprocessorinit-maxbuffersize" id="ref-for-dom-mediastreamtrackprocessorinit-maxbuffersize">maxBufferSize</a></code> has an integer value greater than 1, run the following substeps:</p>
     <ol>
      <li data-md>
       <p>Set <var>maxBufferSize</var> to <var>init</var>.<code class="idl"><a data-link-type="idl" href="#dom-mediastreamtrackprocessorinit-maxbuffersize" id="ref-for-dom-mediastreamtrackprocessorinit-maxbuffersize①">maxBufferSize</a></code>.</p>
      <li data-md>
       <p>The user agent MAY decide to clamp <var>maxBufferSize</var> to a lower value, but no lower than 1.</p>
       <p class="note" role="note"> Clamping <var>maxBufferSize</var> can be useful for some sources like cameras, for instance in case
  they can only use a limited number of VideoFrames at any given time. </p>
     </ol>
    <li data-md>
     <p>Let <var>processor</var> be a new <code class="idl"><a data-link-type="idl" href="#mediastreamtrackprocessor" id="ref-for-mediastreamtrackprocessor①①">MediaStreamTrackProcessor</a></code> object.</p>
    <li data-md>
     <p>Set <var>processor</var>.<code>[[track]]</code> to <var>init</var>.<code class="idl"><a data-link-type="idl" href="#dom-mediastreamtrackprocessorinit-track" id="ref-for-dom-mediastreamtrackprocessorinit-track①">track</a></code>.</p>
    <li data-md>
     <p>Set <var>processor</var>.<code>[[maxBufferSize]]</code> to <var>maxBufferSize</var>.</p>
    <li data-md>
     <p>Set <var>processor</var>.<code>[[queue]]</code> to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#queue" id="ref-for-queue①">queue</a>.</p>
    <li data-md>
     <p>Set <var>processor</var>.<code>[[numPendingReads]]</code> to 0.</p>
    <li data-md>
     <p>Set <var>processor</var>.<code>[[isClosed]]</code> to false.</p>
    <li data-md>
     <p>Return <var>processor</var>.</p>
   </ol>
   <h4 class="heading settled" data-level="2.1.4" id="attributes-processor"><span class="secno">2.1.4. </span><span class="content">Attributes</span><a class="self-link" href="#attributes-processor"></a></h4>
   <dl>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="MediaStreamTrackProcessor" data-dfn-type="attribute" data-export id="dom-mediastreamtrackprocessor-readable"><code>readable</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://streams.spec.whatwg.org/#readablestream" id="ref-for-readablestream⑤">ReadableStream</a>, readonly</span>
    <dd>
     Allows reading the frames delivered by the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack⑧">MediaStreamTrack</a></code> stored
in the <code>[[track]]</code> internal slot. This attribute is created the first time it is invoked
according to the following steps: 
     <ol>
      <li data-md>
       <p>Initialize <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this">this</a>.<code class="idl"><a data-link-type="idl" href="#dom-mediastreamtrackprocessor-readable" id="ref-for-dom-mediastreamtrackprocessor-readable①">readable</a></code> to be a new <code class="idl"><a data-link-type="idl" href="https://streams.spec.whatwg.org/#readablestream" id="ref-for-readablestream⑥">ReadableStream</a></code>.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-set-up" id="ref-for-readablestream-set-up">Set up</a> <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①">this</a>.<code class="idl"><a data-link-type="idl" href="#dom-mediastreamtrackprocessor-readable" id="ref-for-dom-mediastreamtrackprocessor-readable②">readable</a></code> with its <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-set-up-pullalgorithm" id="ref-for-readablestream-set-up-pullalgorithm">pullAlgorithm</a> set to <a data-link-type="dfn" href="#processorpull" id="ref-for-processorpull">processorPull</a> with <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②">this</a> as parameter, <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-set-up-cancelalgorithm" id="ref-for-readablestream-set-up-cancelalgorithm">cancelAlgorithm</a> set to <a data-link-type="dfn" href="#processorcancel" id="ref-for-processorcancel">processorCancel</a> with <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this③">this</a> as parameter, and <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-set-up-highwatermark" id="ref-for-readablestream-set-up-highwatermark">highWatermark</a> set to 0.</p>
     </ol>
     <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="processorpull">processorPull</dfn> algorithm is given a <var>processor</var> as input. It is defined by the following steps:</p>
     <ol>
      <li data-md>
       <p>Increment the value of the <var>processor</var>.<code>[[numPendingReads]]</code> by 1.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task">Queue a task</a> to run the <a data-link-type="dfn" href="#maybereadframe" id="ref-for-maybereadframe">maybeReadFrame</a> algorithm with <var>processor</var> as parameter.</p>
      <li data-md>
       <p>Return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with">a promise resolved with</a> undefined.</p>
     </ol>
     <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="maybereadframe">maybeReadFrame</dfn> algorithm is given a <var>processor</var> as input. It is defined by the following steps:</p>
     <ol>
      <li data-md>
       <p>If <var>processor</var>.<code>[[queue]]</code> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-empty" id="ref-for-list-empty">empty</a>, abort these steps.</p>
      <li data-md>
       <p>If <var>processor</var>.<code>[[numPendingReads]]</code> equals zero, abort these steps.</p>
      <li data-md>
       <p>Let <var>frame</var> be the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#queue-dequeue" id="ref-for-queue-dequeue">dequeueing</a> a frame media data from <var>processor</var>.<code>[[queue]]</code>.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-enqueue" id="ref-for-readablestream-enqueue">Enqueue</a> <var>frame</var> in <var>processor</var>.<code class="idl"><a data-link-type="idl" href="#dom-mediastreamtrackprocessor-readable" id="ref-for-dom-mediastreamtrackprocessor-readable③">readable</a></code>.</p>
      <li data-md>
       <p>Decrement <var>processor</var>.<code>[[numPendingReads]]</code> by 1.</p>
      <li data-md>
       <p>Go to step 1.</p>
     </ol>
     <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="processorcancel">processorCancel</dfn> algorithm is given a <var>processor</var> as input.
It is defined by running the following steps:</p>
     <ol>
      <li data-md>
       <p>Run the <a data-link-type="dfn" href="#processorclose" id="ref-for-processorclose">processorClose</a> algorithm with <var>processor</var> as parameter.</p>
      <li data-md>
       <p>Return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with①">a promise resolved with</a> undefined.</p>
     </ol>
     <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="processorclose">processorClose</dfn> algorithm is given a <var>processor</var> as input.
It is defined by running the following steps:</p>
     <ol>
      <li data-md>
       <p>If <var>processor</var>.<code>[[isClosed]]</code> is true, abort these steps.</p>
      <li data-md>
       <p>Disconnect <var>processor</var> from <var>processor</var>.<code>[[track]]</code>. The mechanism to do this is UA specific and the result is that <var>processor</var> is no longer a sink of <var>processor</var>.<code>[[track]]</code>.</p>
      <li data-md>
       <p><a data-link-type="abstract-op" href="https://streams.spec.whatwg.org/#readable-stream-default-controller-close" id="ref-for-readable-stream-default-controller-close">Close</a> <var>processor</var>.<code class="idl"><a data-link-type="idl" href="#dom-mediastreamtrackprocessor-readable" id="ref-for-dom-mediastreamtrackprocessor-readable④">readable</a></code>.<a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-controller" id="ref-for-readablestream-controller">[[controller]]</a>.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-empty" id="ref-for-list-empty①">Empty</a> <var>processor</var>.<code>[[queue]]</code>.</p>
      <li data-md>
       <p>Set <var>processor</var>.<code>[[isClosed]]</code> to true.</p>
     </ol>
   </dl>
   <h4 class="heading settled" data-level="2.1.5" id="processor-handling-interaction-with-track"><span class="secno">2.1.5. </span><span class="content">Handling interaction with the track</span><a class="self-link" href="#processor-handling-interaction-with-track"></a></h4>
    When the <code>[[track]]</code> of a <code class="idl"><a data-link-type="idl" href="#mediastreamtrackprocessor" id="ref-for-mediastreamtrackprocessor①②">MediaStreamTrackProcessor</a></code> <var>processor</var> delivers a
frame to <var>processor</var>, the UA MUST execute the <a data-link-type="dfn" href="#handlenewframe" id="ref-for-handlenewframe">handleNewFrame</a> algorithm
with <var>processor</var> as parameter. 
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handlenewframe">handleNewFrame</dfn> algorithm is given a <var>processor</var> as input.
It is defined by running the following steps:</p>
   <ol>
    <li data-md>
     <p>If <var>processor</var>.<code>[[queue]]</code> has <var>processor</var>.<code>[[maxBufferSize]]</code> elements, run the following steps:</p>
     <ol>
      <li data-md>
       <p>Let <var>droppedFrame</var> be the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#queue-dequeue" id="ref-for-queue-dequeue①">dequeueing</a> <var>processor</var>.<code>[[queue]]</code>.</p>
      <li data-md>
       <p>Run the <a data-link-type="dfn" href="https://w3c.github.io/webcodecs/#close-videoframe" id="ref-for-close-videoframe">Close VideoFrame</a> algorithm with <var>droppedFrame</var>.</p>
     </ol>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#queue-enqueue" id="ref-for-queue-enqueue">Enqueue</a> the new frame media data in <var>processor</var>.<code>[[queue]]</code>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task①">Queue a task</a> to run the <a data-link-type="dfn" href="#maybereadframe" id="ref-for-maybereadframe①">maybeReadFrame</a> algorithm with <var>processor</var> as parameter.</p>
   </ol>
   <p>At any time, the UA MAY <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove">remove</a> any frame from <var>processor</var>.<code>[[queue]]</code>.
The UA may decide to remove frames from <var>processor</var>.<code>[[queue]]</code>, for example,
to prevent resource exhaustion or to improve performance in certain situations.</p>
   <p class="note" role="note"> The application may detect that frames have been dropped by noticing that there
is a gap in the timestamps of the frames. </p>
   <p>When the <code>[[track]]</code> of a <code class="idl"><a data-link-type="idl" href="#mediastreamtrackprocessor" id="ref-for-mediastreamtrackprocessor①③">MediaStreamTrackProcessor</a></code> <var>processor</var> <a data-link-type="dfn" href="https://drafts.csswg.org/css-text-4/#tracking" id="ref-for-tracking">ends</a>, the <a data-link-type="dfn" href="#processorclose" id="ref-for-processorclose①">processorClose</a> algorithm must be
executed with <var>processor</var> as parameter.</p>
   <h3 class="heading settled" data-level="2.2" id="video-track-generator"><span class="secno">2.2. </span><span class="content">VideoTrackGenerator</span><a class="self-link" href="#video-track-generator"></a></h3>
    A <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator">VideoTrackGenerator</a></code> allows the creation of a video source for a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack⑨">MediaStreamTrack</a></code> in the <a href="https://www.w3.org/TR/mediacapture-streams/#the-model-sources-sinks-constraints-and-settings"> MediaStream model</a> that generates its frames from a Stream of <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webcodecs/#videoframe" id="ref-for-videoframe①">VideoFrame</a></code> objects. It has two readonly
attributes: a <code class="idl"><a data-link-type="idl" href="#dom-videotrackgenerator-writable" id="ref-for-dom-videotrackgenerator-writable">writable</a></code> <code class="idl"><a data-link-type="idl" href="https://streams.spec.whatwg.org/#writablestream" id="ref-for-writablestream">WritableStream</a></code> and a <code class="idl"><a data-link-type="idl" href="#dom-videotrackgenerator-track" id="ref-for-dom-videotrackgenerator-track">track</a></code> <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack①⓪">MediaStreamTrack</a></code>. 
   <p>The <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator①">VideoTrackGenerator</a></code> is the underlying sink] of its <code class="idl"><a data-link-type="idl" href="#dom-videotrackgenerator-writable" id="ref-for-dom-videotrackgenerator-writable①">writable</a></code> attribute. The <code class="idl"><a data-link-type="idl" href="#dom-videotrackgenerator-track" id="ref-for-dom-videotrackgenerator-track①">track</a></code> attribute
is the output. Further tracks connected to the same <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator②">VideoTrackGenerator</a></code> can be
created using the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack-clone" id="ref-for-dom-mediastreamtrack-clone">clone</a></code> method on the <code class="idl"><a data-link-type="idl" href="#dom-videotrackgenerator-track" id="ref-for-dom-videotrackgenerator-track②">track</a></code> attribute.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="https://streams.spec.whatwg.org/#writablestream" id="ref-for-writablestream①">WritableStream</a></code> accepts <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webcodecs/#videoframe" id="ref-for-videoframe②">VideoFrame</a></code> objects.
When a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webcodecs/#videoframe" id="ref-for-videoframe③">VideoFrame</a></code> is written to <code class="idl"><a data-link-type="idl" href="#dom-videotrackgenerator-writable" id="ref-for-dom-videotrackgenerator-writable②">writable</a></code>,
the frame’s <code>close()</code> method is automatically invoked, so that its internal
resources are no longer accessible from JavaScript.</p>
   <p class="note" role="note"><span class="marker">Note:</span> There is consensus in the WG that a source capable of generating a MediaStreamTrack of kind "video" should exist.
There is no WG consensus on whether or not a source capable of generating a MediaStreamTrack of kind "audio" should exist.</p>
   <h4 class="heading settled" data-level="2.2.1" id="video-generator-interface"><span class="secno">2.2.1. </span><span class="content">Interface definition</span><a class="self-link" href="#video-generator-interface"></a></h4>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①"><c- g>Exposed</c-></a>=<c- n>DedicatedWorker</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="videotrackgenerator"><code><c- g>VideoTrackGenerator</c-></code></dfn> {
  <a class="idl-code" data-link-type="constructor" href="#dom-videotrackgenerator-videotrackgenerator" id="ref-for-dom-videotrackgenerator-videotrackgenerator"><c- g>constructor</c-></a>();
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://streams.spec.whatwg.org/#writablestream" id="ref-for-writablestream②"><c- n>WritableStream</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="WritableStream" href="#dom-videotrackgenerator-writable" id="ref-for-dom-videotrackgenerator-writable③"><c- g>writable</c-></a>;
  <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean"><c- b>boolean</c-></a> <a class="idl-code" data-link-type="attribute" data-type="boolean" href="#dom-videotrackgenerator-muted" id="ref-for-dom-videotrackgenerator-muted"><c- g>muted</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack①①"><c- n>MediaStreamTrack</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="MediaStreamTrack" href="#dom-videotrackgenerator-track" id="ref-for-dom-videotrackgenerator-track③"><c- g>track</c-></a>;
};
</pre>
   <p class="note" role="note"><span class="marker">Note:</span> There is WG consensus that this interface should be exposed on DedicatedWorker.
There is no WG consensus on whether or not it should be exposed on Window.</p>
   <h4 class="heading settled" data-level="2.2.2" id="internal-slots"><span class="secno">2.2.2. </span><span class="content">Internal slots</span><a class="self-link" href="#internal-slots"></a></h4>
   <dl>
    <dt><dfn class="idl-code" data-dfn-for="VideoTrackGenerator" data-dfn-type="attribute" data-export id="dom-videotrackgenerator-track-slot"><code>[[track]]</code><a class="self-link" href="#dom-videotrackgenerator-track-slot"></a></dfn>
    <dd>The <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack①②">MediaStreamTrack</a></code> output of this source
    <dt><dfn class="idl-code" data-dfn-for="VideoTrackGenerator" data-dfn-type="attribute" data-export id="dom-videotrackgenerator-ismuted-slot"><code>[[isMuted]]</code><a class="self-link" href="#dom-videotrackgenerator-ismuted-slot"></a></dfn>
    <dd>A boolean whose value indicates whether this source and all the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack①③">MediaStreamTrack</a></code>s it sources, are currently <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack-muted" id="ref-for-dom-mediastreamtrack-muted">muted</a></code> or not. 
   </dl>
   <h4 class="heading settled" data-level="2.2.3" id="video-generator-constructor"><span class="secno">2.2.3. </span><span class="content">Constructor</span><a class="self-link" href="#video-generator-constructor"></a></h4>
    <dfn class="dfn-paneled idl-code" data-dfn-for="VideoTrackGenerator" data-dfn-type="constructor" data-export data-lt="VideoTrackGenerator()|constructor()" id="dom-videotrackgenerator-videotrackgenerator" title="VideoTrackGenerator(init)"><code> VideoTrackGenerator() </code></dfn> 
   <ol>
    <li data-md>
     <p>Let <var>generator</var> be a new <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator③">VideoTrackGenerator</a></code> object.</p>
    <li data-md>
     <p>Let <var>track</var> be a newly <a data-link-type="abstract-op" href="https://w3c.github.io/mediacapture-main/#dfn-create-a-mediastreamtrack" id="ref-for-dfn-create-a-mediastreamtrack">created</a> <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack①④">MediaStreamTrack</a></code> with <var>source</var> set to <var>generator</var> and <var>tieSourceToContext</var> set to <code>false</code>.</p>
    <li data-md>
     <p>Initialize <var>generator</var>.<code class="idl"><a data-link-type="idl" href="#dom-videotrackgenerator-track" id="ref-for-dom-videotrackgenerator-track④">track</a></code> to <var>track</var>.</p>
    <li data-md>
     <p>Return <var>generator</var>.</p>
   </ol>
   <h4 class="heading settled" data-level="2.2.4" id="video-generator-attributes"><span class="secno">2.2.4. </span><span class="content">Attributes</span><a class="self-link" href="#video-generator-attributes"></a></h4>
   <dl>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="VideoTrackGenerator" data-dfn-type="attribute" data-export id="dom-videotrackgenerator-writable"><code>writable</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://streams.spec.whatwg.org/#writablestream" id="ref-for-writablestream③">WritableStream</a>, readonly</span>
    <dd>
     Allows writing video frames to the <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator④">VideoTrackGenerator</a></code>. When this attribute
is accessed for the first time, it MUST be initialized with the following steps: 
     <ol>
      <li data-md>
       <p>Initialize <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this④">this</a>.<code class="idl"><a data-link-type="idl" href="#dom-videotrackgenerator-writable" id="ref-for-dom-videotrackgenerator-writable④">writable</a></code> to be a new <code class="idl"><a data-link-type="idl" href="https://streams.spec.whatwg.org/#writablestream" id="ref-for-writablestream④">WritableStream</a></code>.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://streams.spec.whatwg.org/#writablestream-set-up" id="ref-for-writablestream-set-up">Set up</a> <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑤">this</a>.<code class="idl"><a data-link-type="idl" href="#dom-videotrackgenerator-writable" id="ref-for-dom-videotrackgenerator-writable⑤">writable</a></code>, with its <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#writablestream-set-up-writealgorithm" id="ref-for-writablestream-set-up-writealgorithm">writeAlgorithm</a> set to <a data-link-type="dfn" href="#writeframe" id="ref-for-writeframe">writeFrame</a> with <var>this</var> as parameter, with <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#writablestream-set-up-closealgorithm" id="ref-for-writablestream-set-up-closealgorithm">closeAlgorithm</a> set to <a data-link-type="dfn" href="#closewritable" id="ref-for-closewritable">closeWritable</a> with <var>this</var> as parameter and <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#writablestream-set-up-abortalgorithm" id="ref-for-writablestream-set-up-abortalgorithm">abortAlgorithm</a> set to <a data-link-type="dfn" href="#closewritable" id="ref-for-closewritable①">closeWritable</a> with <var>this</var> as parameter.</p>
     </ol>
     <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="writeframe">writeFrame</dfn> algorithm is given a <var>generator</var> and a <var>frame</var> as input. It is defined by running the following steps:</p>
     <ol>
      <li data-md>
       <p>If <var>frame</var> is not a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webcodecs/#videoframe" id="ref-for-videoframe④">VideoFrame</a></code> object, return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with">a promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror①">TypeError</a></code>.</p>
      <li data-md>
       <p>If the value of <var>frame</var>’s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/structured-data.html#detached" id="ref-for-detached">[[Detached]]</a></code> internal slot is true, return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①">a promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror②">TypeError</a></code>.</p>
      <li data-md>
       <p>If <var>generator</var>.<code>[[isMuted]]</code> is false, for each live track sourced from <var>generator</var>, named <var>track</var>, run the following steps:</p>
       <ol>
        <li data-md>
         <p>Let <var>clone</var> be the result of running the <a data-link-type="dfn" href="https://w3c.github.io/webcodecs/#clone-videoframe" id="ref-for-clone-videoframe">Clone videoFrame</a> algorithm with <var>frame</var>.</p>
        <li data-md>
         <p>Send <var>clone</var> to <var>track</var>.</p>
       </ol>
      <li data-md>
       <p>Run the <a data-link-type="dfn" href="https://w3c.github.io/webcodecs/#close-videoframe" id="ref-for-close-videoframe①">Close VideoFrame</a> algorithm with <var>frame</var>.</p>
      <li data-md>
       <p>Return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with②">a promise resolved with</a> undefined.</p>
     </ol>
     <p class="note" role="note"> When the media data is sent to a track, the UA may apply processing
(e.g., cropping and downscaling) to ensure that the media data sent
to the track satisfies the track’s constraints. Each track may receive a
different version of the media data depending on its constraints. </p>
     <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="closewritable">closeWritable</dfn> algorithm is given a <var>generator</var> as input.
It is defined by running the following steps.</p>
     <ol>
      <li data-md>
       <p>For each track <code>t</code> sourced from <var>generator</var>, <a data-link-type="dfn" href="https://drafts.csswg.org/css-text-4/#tracking" id="ref-for-tracking①">end</a> <code>t</code>.</p>
      <li data-md>
       <p>Return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with③">a promise resolved with</a> undefined.</p>
     </ol>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="VideoTrackGenerator" data-dfn-type="attribute" data-export id="dom-videotrackgenerator-muted"><code>muted</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean①">boolean</a></span>
    <dd>
     Mutes the <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator⑤">VideoTrackGenerator</a></code>. The getter steps are to return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑥">this</a>.<code>[[isMuted]]</code>. The setter steps, given a value <var>newValue</var>, are as follows: 
     <ol>
      <li data-md>
       <p>If <var>newValue</var> is equal to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑦">this</a>.<code>[[isMuted]]</code>, abort these steps.</p>
      <li data-md>
       <p>Set <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑧">this</a>.<code>[[isMuted]]</code> to <var>newValue</var>.</p>
      <li data-md>
       <p>Unless one has been queued already this run of the event loop, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task②">queue a task</a> to run the following steps:</p>
       <ol>
        <li data-md>
         <p>Let <var>settledValue</var> be <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑨">this</a>.<code>[[isMuted]]</code>.</p>
        <li data-md>
         <p>For each live track sourced by <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①⓪">this</a>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task③">queue a task</a> to <a data-link-type="abstract-op" href="https://w3c.github.io/mediacapture-main/#set-track-muted" id="ref-for-set-track-muted">set a track’s muted state</a> to <var>settledValue</var>.</p>
       </ol>
     </ol>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="VideoTrackGenerator" data-dfn-type="attribute" data-export id="dom-videotrackgenerator-track"><code>track</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack①⑤">MediaStreamTrack</a>, readonly</span>
    <dd>The <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack①⑥">MediaStreamTrack</a></code> output. The getter steps are to return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①①">this</a>.<code>[[track]]</code>. 
   </dl>
   <h4 class="heading settled" data-level="2.2.5" id="video-generator-as-track"><span class="secno">2.2.5. </span><span class="content">Specialization of MediaStreamTrack behavior</span><a class="self-link" href="#video-generator-as-track"></a></h4>
    A <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator⑥">VideoTrackGenerator</a></code> acts as the source for one or more <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack①⑦">MediaStreamTrack</a></code>s.
This section adds clarifications on how a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack①⑧">MediaStreamTrack</a></code> sourced from a <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator⑦">VideoTrackGenerator</a></code> behaves. 
   <h5 class="heading settled" data-level="2.2.5.1" id="video-generator-stop"><span class="secno">2.2.5.1. </span><span class="content">stop</span><a class="self-link" href="#video-generator-stop"></a></h5>
    The <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack-stop" id="ref-for-dom-mediastreamtrack-stop">stop</a></code> method stops the track. When the last track
sourced from a <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator⑧">VideoTrackGenerator</a></code> ends, that <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator⑨">VideoTrackGenerator</a></code>'s <code class="idl"><a data-link-type="idl" href="#dom-videotrackgenerator-writable" id="ref-for-dom-videotrackgenerator-writable⑥">writable</a></code> is <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#writablestream-close" id="ref-for-writablestream-close">closed</a>. 
   <h5 class="heading settled" data-level="2.2.5.2" id="generator-constrainable-properties"><span class="secno">2.2.5.2. </span><span class="content">Constrainable properties</span><a class="self-link" href="#generator-constrainable-properties"></a></h5>
   <p>The following constrainable properties are defined for any <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack①⑨">MediaStreamTrack</a></code>s sourced from
a <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator①⓪">VideoTrackGenerator</a></code>:</p>
   <table>
    <thead>
     <tr>
      <th> Property Name 
      <th> Values 
      <th> Notes 
    <tbody>
     <tr id="def-constraint-width">
      <td> width 
      <td> <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-constrainulong" id="ref-for-dom-constrainulong">ConstrainULong</a></code> 
      <td> As a setting, this is the width, in pixels, of the latest
        frame received by the track.
        As a capability, <code>max</code> MUST reflect the
        largest width a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webcodecs/#videoframe" id="ref-for-videoframe⑤">VideoFrame</a></code> may have, and <code>min</code> MUST reflect the smallest width a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webcodecs/#videoframe" id="ref-for-videoframe⑥">VideoFrame</a></code> may have. 
     <tr id="def-constraint-height">
      <td> height 
      <td> <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-constrainulong" id="ref-for-dom-constrainulong①">ConstrainULong</a></code> 
      <td> As a setting, this is the height, in pixels, of the latest
        frame received by the track.
        As a capability, <code>max</code> MUST reflect the largest height
        a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webcodecs/#videoframe" id="ref-for-videoframe⑦">VideoFrame</a></code> may have, and <code>min</code> MUST reflect
        the smallest height a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webcodecs/#videoframe" id="ref-for-videoframe⑧">VideoFrame</a></code> may have. 
     <tr id="def-constraint-frameRate">
      <td> frameRate 
      <td> <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-constraindouble" id="ref-for-dom-constraindouble">ConstrainDouble</a></code> 
      <td> As a setting, this is an estimate of the frame rate based on frames
        recently received by the track.
        As a capability <code>min</code> MUST be zero and <code>max</code> MUST be the maximum frame rate supported by the system. 
     <tr id="def-constraint-aspect">
      <td> aspectRatio 
      <td> <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-constraindouble" id="ref-for-dom-constraindouble①">ConstrainDouble</a></code> 
      <td> As a setting, this is the aspect ratio of the latest frame
        delivered by the track;
        this is the width in pixels divided by height in pixels as a
        double rounded to the tenth decimal place. As a capability, <code>min</code> MUST be the
        smallest aspect ratio supported by a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webcodecs/#videoframe" id="ref-for-videoframe⑨">VideoFrame</a></code>, and <code>max</code> MUST be
        the largest aspect ratio supported by a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webcodecs/#videoframe" id="ref-for-videoframe①⓪">VideoFrame</a></code>. 
     <tr id="def-constraint-resizeMode">
      <td> resizeMode 
      <td> <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-constraindomstring" id="ref-for-dom-constraindomstring">ConstrainDOMString</a></code> 
      <td> As a setting, this string should be one of the members of <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-videoresizemodeenum" id="ref-for-dom-videoresizemodeenum">VideoResizeModeEnum</a></code>. The value "<code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#idl-def-VideoResizeModeEnum.user" id="ref-for-idl-def-VideoResizeModeEnum.user">none</a></code>"
        means that the frames output by the MediaStreamTrack are unmodified
        versions of the frames written to the <code class="idl"><a data-link-type="idl" href="#dom-videotrackgenerator-writable" id="ref-for-dom-videotrackgenerator-writable⑦">writable</a></code> backing
        the track, regardless of any constraints.
        The value "<code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#idl-def-VideoResizeModeEnum.right" id="ref-for-idl-def-VideoResizeModeEnum.right">crop-and-scale</a></code>" means
        that the frames output by the MediaStreamTrack may be cropped and/or
        downscaled versions
        of the source frames, based on the values of the width, height and
        aspectRatio constraints of the track.
        As a capability, the values "<code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#idl-def-VideoResizeModeEnum.user" id="ref-for-idl-def-VideoResizeModeEnum.user①">none</a></code>" and
        "<code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#idl-def-VideoResizeModeEnum.right" id="ref-for-idl-def-VideoResizeModeEnum.right①">crop-and-scale</a></code>" both MUST be present. 
   </table>
   <p>The <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack-applyconstraints" id="ref-for-dom-mediastreamtrack-applyconstraints">applyConstraints</a></code> method applied to a video <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack②⓪">MediaStreamTrack</a></code> sourced from a <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator①①">VideoTrackGenerator</a></code> supports the properties defined above.
It can be used, for example, to resize frames or adjust the frame rate of the track.
Note that these constraints have no effect on the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webcodecs/#videoframe" id="ref-for-videoframe①①">VideoFrame</a></code> objects
written to the <code class="idl"><a data-link-type="idl" href="#dom-videotrackgenerator-writable" id="ref-for-dom-videotrackgenerator-writable⑧">writable</a></code> of a <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator①②">VideoTrackGenerator</a></code>,
just on the output of the track on which the constraints have been applied.
Note also that, since a <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator①③">VideoTrackGenerator</a></code> can in principle produce
media data with any setting for the supported constrainable properties,
an <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack-applyconstraints" id="ref-for-dom-mediastreamtrack-applyconstraints①">applyConstraints</a></code> call on a track
backed by a <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator①④">VideoTrackGenerator</a></code> will generally not fail with <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-overconstrainederror" id="ref-for-dom-overconstrainederror">OverconstrainedError</a></code> unless the given constraints
are outside the system-supported range, as reported by <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack-getcapabilities" id="ref-for-dom-mediastreamtrack-getcapabilities">getCapabilities</a></code>.</p>
   <h5 class="heading settled" data-level="2.2.5.3" id="generator-events-attributes"><span class="secno">2.2.5.3. </span><span class="content">Events and attributes</span><a class="self-link" href="#generator-events-attributes"></a></h5>
    Events and attributes work the same as for any <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack②①">MediaStreamTrack</a></code>.
It is relevant to note that if the <code class="idl"><a data-link-type="idl" href="#dom-videotrackgenerator-writable" id="ref-for-dom-videotrackgenerator-writable⑨">writable</a></code> stream of a <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator①⑤">VideoTrackGenerator</a></code> is closed, all the live
tracks connected to it are ended and the <code>ended</code> event is fired on them. 
   <h2 class="heading settled" data-level="3" id="examples"><span class="secno">3. </span><span class="content">Examples</span><a class="self-link" href="#examples"></a></h2>
   <h3 class="heading settled" data-level="3.1" id="video-processing"><span class="secno">3.1. </span><span class="content">Video Processing</span><a class="self-link" href="#video-processing"></a></h3>
    Consider a face recognition function <code>detectFace(videoFrame)</code> that returns a face position
(in some format), and a manipulation function <code>blurBackground(videoFrame, facePosition)</code> that
returns a new VideoFrame similar to the given <code>videoFrame</code>, but with the
non-face parts blurred. The example also shows the video before and after
effects on video elements. 
<pre class="example highlight" id="example-b482e2d8"><a class="self-link" href="#example-b482e2d8"></a><c- c1>// main.js</c->

<c- a>const</c-> stream <c- o>=</c-> <c- k>await</c-> navigator<c- p>.</c->mediaDevices<c- p>.</c->getUserMedia<c- p>({</c->video<c- o>:</c-><c- kc>true</c-><c- p>});</c->
<c- a>const</c-> videoBefore <c- o>=</c-> document<c- p>.</c->getElementById<c- p>(</c-><c- t>'video-before'</c-><c- p>);</c->
<c- a>const</c-> videoAfter <c- o>=</c-> document<c- p>.</c->getElementById<c- p>(</c-><c- t>'video-after'</c-><c- p>);</c->
videoBefore<c- p>.</c->srcObject <c- o>=</c-> stream<c- p>.</c->clone<c- p>();</c->

<c- a>const</c-> <c- p>[</c->track<c- p>]</c-> <c- o>=</c-> stream<c- p>.</c->getVideoTracks<c- p>();</c->
<c- a>const</c-> worker <c- o>=</c-> <c- ow>new</c-> Worker<c- p>(</c-><c- t>'worker.js'</c-><c- p>);</c->
worker<c- p>.</c->postMessage<c- p>({</c->track<c- p>},</c-> <c- p>[</c->track<c- p>]);</c->

<c- a>const</c-> <c- p>{</c->data<c- p>}</c-> <c- o>=</c-> <c- k>await</c-> <c- ow>new</c-> Promise<c- p>(</c->r <c- p>=></c-> worker<c- p>.</c->onmessage<c- p>);</c->
videoAfter<c- p>.</c->srcObject <c- o>=</c-> <c- ow>new</c-> MediaStream<c- p>([</c->data<c- p>.</c->track<c- p>]);</c->

<c- c1>// worker.js</c->

self<c- p>.</c->onmessage <c- o>=</c-> <c- k>async</c-> <c- p>({</c->data<c- o>:</c-> <c- p>{</c->track<c- p>}})</c-> <c- p>=></c-> <c- p>{</c->
  <c- a>const</c-> source <c- o>=</c-> <c- ow>new</c-> VideoTrackGenerator<c- p>();</c->
  parent<c- p>.</c->postMessage<c- p>({</c->track<c- o>:</c-> source<c- p>.</c->track<c- p>},</c-> <c- p>[</c->source<c- p>.</c->track<c- p>]);</c->

  <c- a>const</c-> <c- p>{</c->readable<c- p>}</c-> <c- o>=</c-> <c- ow>new</c-> MediaStreamTrackProcessor<c- p>({</c->track<c- p>});</c->
  <c- a>const</c-> transformer <c- o>=</c-> <c- ow>new</c-> TransformStream<c- p>({</c->
    <c- k>async</c-> transform<c- p>(</c->frame<c- p>,</c-> controller<c- p>)</c-> <c- p>{</c->
      <c- a>const</c-> facePosition <c- o>=</c-> <c- k>await</c-> detectFace<c- p>(</c->frame<c- p>);</c->
      <c- a>const</c-> newFrame <c- o>=</c-> blurBackground<c- p>(</c->frame<c- p>,</c-> facePosition<c- p>);</c->
      frame<c- p>.</c->close<c- p>();</c->
      controller<c- p>.</c->enqueue<c- p>(</c->newFrame<c- p>);</c->
    <c- p>}</c->
  <c- p>});</c->
  <c- k>await</c-> readable<c- p>.</c->pipeThrough<c- p>(</c->transformer<c- p>).</c->pipeTo<c- p>(</c->source<c- p>.</c->writable<c- p>);</c->
<c- p>};</c->
</pre>
   <h3 class="heading settled" data-level="3.2" id="multi-consumer-constraints"><span class="secno">3.2. </span><span class="content">Multi-consumer post-processing with constraints</span><a class="self-link" href="#multi-consumer-constraints"></a></h3>
    A common use case is to remove the background from live camera video fed into a
video conference, with a live self-view showing the result. It’s desirable for
the self-view to have a high frame rate even if the frame rate used for actual
sending may dip lower due to back pressure from bandwidth constraints. This can
be achieved by applying constraints to a track clone, avoiding having to process
twice. 
<pre class="example highlight" id="example-b49a6910"><a class="self-link" href="#example-b49a6910"></a><c- c1>// main.js</c->

<c- a>const</c-> stream <c- o>=</c-> <c- k>await</c-> navigator<c- p>.</c->mediaDevices<c- p>.</c->getUserMedia<c- p>({</c->video<c- o>:</c-><c- kc>true</c-><c- p>});</c->
<c- a>const</c-> <c- p>[</c->track<c- p>]</c-> <c- o>=</c-> stream<c- p>.</c->getVideoTracks<c- p>();</c->
<c- a>const</c-> worker <c- o>=</c-> <c- ow>new</c-> Worker<c- p>(</c-><c- t>'worker.js'</c-><c- p>);</c->
worker<c- p>.</c->postMessage<c- p>({</c->track<c- p>},</c-> <c- p>[</c->track<c- p>]);</c->

<c- a>const</c-> <c- p>{</c->data<c- p>}</c-> <c- o>=</c-> <c- k>await</c-> <c- ow>new</c-> Promise<c- p>(</c->r <c- p>=></c-> worker<c- p>.</c->onmessage<c- p>);</c->
<c- a>const</c-> selfView <c- o>=</c-> document<c- p>.</c->getElementById<c- p>(</c-><c- t>'video-self'</c-><c- p>);</c->
selfView<c- p>.</c->srcObject <c- o>=</c-> <c- ow>new</c-> MediaStream<c- p>([</c->data<c- p>.</c->track<c- p>.</c->clone<c- p>()]);</c-> <c- c1>// 60 fps</c->

<c- k>await</c-> data<c- p>.</c->track<c- p>.</c->applyConstraints<c- p>({</c->width<c- o>:</c-> <c- mf>320</c-><c- p>,</c-> height<c- o>:</c-> <c- mf>200</c-><c- p>,</c-> frameRate<c- o>:</c-> <c- mf>30</c-><c- p>});</c->
<c- a>const</c-> pc <c- o>=</c-> <c- ow>new</c-> RTCPeerConnection<c- p>(</c->config<c- p>);</c->
pc<c- p>.</c->addTrack<c- p>(</c->data<c- p>.</c->track<c- p>);</c-> <c- c1>// 30 fps</c->

<c- c1>// worker.js</c->

self<c- p>.</c->onmessage <c- o>=</c-> <c- k>async</c-> <c- p>({</c->data<c- o>:</c-> <c- p>{</c->track<c- p>}})</c-> <c- p>=></c-> <c- p>{</c->
  <c- a>const</c-> source <c- o>=</c-> <c- ow>new</c-> VideoTrackGenerator<c- p>();</c->
  parent<c- p>.</c->postMessage<c- p>({</c->track<c- o>:</c-> source<c- p>.</c->track<c- p>},</c-> <c- p>[</c->source<c- p>.</c->track<c- p>]);</c->

  <c- a>const</c-> <c- p>{</c->readable<c- p>}</c-> <c- o>=</c-> <c- ow>new</c-> MediaStreamTrackProcessor<c- p>({</c->track<c- p>});</c->
  <c- a>const</c-> transformer <c- o>=</c-> <c- ow>new</c-> TransformStream<c- p>({</c->transform<c- o>:</c-> myRemoveBackgroundFromVideo<c- p>});</c->
  <c- k>await</c-> readable<c- p>.</c->pipeThrough<c- p>(</c->transformer<c- p>).</c->pipeTo<c- p>(</c->source<c- p>.</c->writable<c- p>);</c->
<c- p>};</c->
</pre>
   <h3 class="heading settled" data-level="3.3" id="multi-consumer-worker"><span class="secno">3.3. </span><span class="content">Multi-consumer post-processing with constraints in a worker</span><a class="self-link" href="#multi-consumer-worker"></a></h3>
    Being able to show a higher frame-rate self-view is also relevant when sending
video frames over WebTransport in a worker. The same technique above may be used
here, except constraints are applied to a track clone in the worker. 
<pre class="example highlight" id="example-d7741017"><a class="self-link" href="#example-d7741017"></a><c- c1>// main.js</c->

<c- a>const</c-> stream <c- o>=</c-> <c- k>await</c-> navigator<c- p>.</c->mediaDevices<c- p>.</c->getUserMedia<c- p>({</c->video<c- o>:</c-><c- kc>true</c-><c- p>});</c->
<c- a>const</c-> <c- p>[</c->track<c- p>]</c-> <c- o>=</c-> stream<c- p>.</c->getVideoTracks<c- p>();</c->
<c- a>const</c-> worker <c- o>=</c-> <c- ow>new</c-> Worker<c- p>(</c-><c- t>'worker.js'</c-><c- p>);</c->
worker<c- p>.</c->postMessage<c- p>({</c->track<c- p>},</c-> <c- p>[</c->track<c- p>]);</c->

<c- a>const</c-> <c- p>{</c->data<c- p>}</c-> <c- o>=</c-> <c- k>await</c-> <c- ow>new</c-> Promise<c- p>(</c->r <c- p>=></c-> worker<c- p>.</c->onmessage<c- p>);</c->
<c- a>const</c-> selfView <c- o>=</c-> document<c- p>.</c->getElementById<c- p>(</c-><c- t>'video-self'</c-><c- p>);</c->
selfView<c- p>.</c->srcObject <c- o>=</c-> <c- ow>new</c-> MediaStream<c- p>([</c->data<c- p>.</c->track<c- p>]);</c-> <c- c1>// 60 fps</c->

<c- c1>// worker.js</c->

self<c- p>.</c->onmessage <c- o>=</c-> <c- k>async</c-> <c- p>({</c->data<c- o>:</c-> <c- p>{</c->track<c- p>}})</c-> <c- p>=></c-> <c- p>{</c->
  <c- a>const</c-> source <c- o>=</c-> <c- ow>new</c-> VideoTrackGenerator<c- p>();</c->
  <c- a>const</c-> sendTrack <c- o>=</c-> source<c- p>.</c->track<c- p>.</c->clone<c- p>();</c->
  parent<c- p>.</c->postMessage<c- p>({</c->track<c- o>:</c-> source<c- p>.</c->track<c- p>},</c-> <c- p>[</c->source<c- p>.</c->track<c- p>]);</c->

  <c- k>await</c-> sendTrack<c- p>.</c->applyConstraints<c- p>({</c->width<c- o>:</c-> <c- mf>320</c-><c- p>,</c-> height<c- o>:</c-> <c- mf>200</c-><c- p>,</c-> frameRate<c- o>:</c-> <c- mf>30</c-><c- p>});</c->

  <c- a>const</c-> wt <c- o>=</c-> <c- ow>new</c-> WebTransport<c- p>(</c-><c- u>"https://webtransport.org:8080/up"</c-><c- p>);</c->

  <c- a>const</c-> <c- p>{</c->readable<c- p>}</c-> <c- o>=</c-> <c- ow>new</c-> MediaStreamTrackProcessor<c- p>({</c->track<c- p>});</c->
  <c- a>const</c-> transformer <c- o>=</c-> <c- ow>new</c-> TransformStream<c- p>({</c->transform<c- o>:</c-> myRemoveBackgroundFromVideo<c- p>});</c->
  <c- k>await</c-> readable<c- p>.</c->pipeThrough<c- p>(</c->transformer<c- p>)</c->
    <c- p>.</c->pipeThrough<c- p>({</c->writable<c- o>:</c-> source<c- p>.</c->writable<c- p>,</c-> readable<c- o>:</c-> sendTrack<c- p>.</c->readable<c- p>}),</c->
    <c- p>.</c->pipeThrough<c- p>(</c->createMyEncodeVideoStream<c- p>({</c->
      codec<c- o>:</c-> <c- u>"vp8"</c-><c- p>,</c->
      width<c- o>:</c-> <c- mf>640</c-><c- p>,</c->
      height<c- o>:</c-> <c- mf>480</c-><c- p>,</c->
      bitrate<c- o>:</c-> <c- mf>1000000</c-><c- p>,</c->
    <c- p>}))</c->
    <c- p>.</c->pipeThrough<c- p>(</c-><c- ow>new</c-> TransformStream<c- p>({</c->transform<c- o>:</c-> mySerializer<c- p>}));</c->
    <c- p>.</c->pipeTo<c- p>(</c->wt<c- p>.</c->createUnidirectionalStream<c- p>());</c-> <c- c1>// 30 fps</c->
<c- p>};</c->
</pre>
   <div class="note" role="note">
    <p>The above example avoids using the <code>tee()</code> function to serve multiple
consumers, due to its issues with real-time streams.</p>
    <p>For brevity, the example also over-simplifies using a WebCodecs wrapper to
encode and send video frames over a single WebTransport stream (incurring
head-of-line blocking).</p>
   </div>
   <h2 class="heading settled" data-level="4" id="implementation-advice"><span class="secno">4. </span><span class="content">Implementation advice</span><a class="self-link" href="#implementation-advice"></a></h2>
   <p>This section is informative.</p>
   <h3 class="heading settled" data-level="4.1" id="multi-consumers"><span class="secno">4.1. </span><span class="content">Use with multiple consumers</span><a class="self-link" href="#multi-consumers"></a></h3>
   <p>There are use cases where the programmer may desire that a single stream of frames
is consumed by multiple consumers.</p>
   <p>Examples include the case where the result of a background blurring function should
be both displayed in a self-view and encoded using a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webcodecs/#videoencoder" id="ref-for-videoencoder">VideoEncoder</a></code>.</p>
   <p>For cases where both consumers are consuming unprocessed frames, and synchronization
is not desired, instantianting multiple <code class="idl"><a data-link-type="idl" href="#mediastreamtrackprocessor" id="ref-for-mediastreamtrackprocessor①④">MediaStreamTrackProcessor</a></code> objects is a robust solution.</p>
   <p>For cases where both consumers intend to convert the result of a processing step into a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack②②">MediaStreamTrack</a></code> using a <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator①⑥">VideoTrackGenerator</a></code>, for example when feeding a processed stream
to both a &lt;video> tag and an <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcpeerconnection" id="ref-for-dom-rtcpeerconnection①">RTCPeerConnection</a></code>, attaching the resulting <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack②③">MediaStreamTrack</a></code> to multiple sinks may be the most appropriate mechanism.</p>
   <p>For cases where the downstream processing takes frames, not streams, the frames can
be cloned as needed and sent off to the downstream processing; "clone" is a cheap operation.</p>
   <p>When the stream is the output of some processing, and both branches need a Stream object
to do further processing, one needs a function that produces two streams from one stream.</p>
   <p>However, the standard tee() operation is problematic
in this context:</p>
   <ul>
    <li data-md>
     <p>It defeats the backpressure mechanism that guards against excessive queueing</p>
    <li data-md>
     <p>It creates multiple links to the same buffers, meaning that the question of which
consumer gets to destroy() the buffer is a difficult one to address</p>
   </ul>
   <p>Therefore, the use of tee() with Streams containing media should only be done when
fully understanding the implications. Instead, custom elements for splitting streams
more appropriate to the use case should be used.</p>
   <ul>
    <li data-md>
     <p>If both branches require the ability to dispose of the frames, clone() the frame
and enqueue distinct copies in both queues. This corresponds to the function
ReadableStreamTee(stream, cloneForBranch2=true). Then choose one of the
alternatives below.</p>
    <li data-md>
     <p>If one branch requires all frames, and the other branch tolerates dropped frames,
enqueue buffers in the all-frames-required stream and use the backpressure signal
from that stream to stop reading from the source. If backpressure signal from the
other stream indicates room, enqueue the same frame in that queue too.</p>
    <li data-md>
     <p>If neither stream tolerates dropped frames, use the combined backpressure signal
to stop reading from the source. In this case, frames will be processed in
lockstep if the buffer sizes are both 1.</p>
    <li data-md>
     <p>If it is OK for the incoming stream to be stalled only when the underlying
buffer pool allocated to the process is exhausted, standard tee() may be used.</p>
   </ul>
   <p class="note" role="note"><span class="marker">Note:</span> There are issues filed on the Streams spec where the resolution might affect this section: https://github.com/whatwg/streams/issues/1157, https://github.com/whatwg/streams/issues/1156, https://github.com/whatwg/streams/issues/401, https://github.com/whatwg/streams/issues/1186</p>
   <h2 class="heading settled" data-level="5" id="security-considerations"><span class="secno">5. </span><span class="content">Security and Privacy considerations</span><a class="self-link" href="#security-considerations"></a></h2>
   <p>This API defines a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack②④">MediaStreamTrack</a></code> source and a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack②⑤">MediaStreamTrack</a></code> sink.
The security and privacy of the source (<code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator①⑦">VideoTrackGenerator</a></code>) relies
on the same-origin policy. That is, the data <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator①⑧">VideoTrackGenerator</a></code> can
make available in the form of a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack②⑥">MediaStreamTrack</a></code> must be visible to
the document before a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webcodecs/#videoframe" id="ref-for-videoframe①②">VideoFrame</a></code> object can be constructed
and pushed into the <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator①⑨">VideoTrackGenerator</a></code>. Any attempt to create <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webcodecs/#videoframe" id="ref-for-videoframe①③">VideoFrame</a></code> objects using cross-origin data will fail.
Therefore, <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator②⓪">VideoTrackGenerator</a></code> does not introduce any new
fingerprinting surface.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack②⑦">MediaStreamTrack</a></code> sink introduced by this API (<code class="idl"><a data-link-type="idl" href="#mediastreamtrackprocessor" id="ref-for-mediastreamtrackprocessor①⑤">MediaStreamTrackProcessor</a></code>)
exposes <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack②⑧">MediaStreamTrack</a></code> the same data that is exposed by other <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack②⑨">MediaStreamTrack</a></code> sinks such as WebRTC peer connections, and media elements. The security and privacy
of <code class="idl"><a data-link-type="idl" href="#mediastreamtrackprocessor" id="ref-for-mediastreamtrackprocessor①⑥">MediaStreamTrackProcessor</a></code> relies on the security and privacy of the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack③⓪">MediaStreamTrack</a></code> sources of the tracks to which <code class="idl"><a data-link-type="idl" href="#mediastreamtrackprocessor" id="ref-for-mediastreamtrackprocessor①⑦">MediaStreamTrackProcessor</a></code> is connected. For example, camera, microphone and screen-capture tracks
rely on explicit use authorization via permission dialogs (see <a data-link-type="biblio" href="#biblio-mediacapture-streams" title="Media Capture and Streams">[MEDIACAPTURE-STREAMS]</a> and <a data-link-type="biblio" href="#biblio-screen-capture" title="Screen Capture">[SCREEN-CAPTURE]</a>),
while element capture and <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator②①">VideoTrackGenerator</a></code> rely on the same-origin policy.</p>
   <p>A potential issue with <code class="idl"><a data-link-type="idl" href="#mediastreamtrackprocessor" id="ref-for-mediastreamtrackprocessor①⑧">MediaStreamTrackProcessor</a></code> is resource exhaustion.
For example, a site might hold on to too many open <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webcodecs/#videoframe" id="ref-for-videoframe①④">VideoFrame</a></code> objects
and deplete a system-wide pool of GPU-memory-backed frames. UAs can
mitigate this risk by limiting the number of pool-backed frames a site can
hold. This can be achieved by reducing the maximum number of buffered frames
and by refusing to deliver more frames to <code class="idl"><a data-link-type="idl" href="#dom-mediastreamtrackprocessor-readable" id="ref-for-dom-mediastreamtrackprocessor-readable⑤">readable</a></code> once the budget limit is reached. Accidental exhaustion is also mitigated by
automatic closing of <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webcodecs/#videoframe" id="ref-for-videoframe①⑤">VideoFrame</a></code> objects once they
are written to a <code class="idl"><a data-link-type="idl" href="#videotrackgenerator" id="ref-for-videotrackgenerator②②">VideoTrackGenerator</a></code>.</p>
   <h2 class="heading settled" data-level="6" id="backwards-compatibility"><span class="secno">6. </span><span class="content">Backwards compatibility with earlier proposals</span><a class="self-link" href="#backwards-compatibility"></a></h2>
   <p>This section is informative.</p>
   <p>Previous proposals for this interface had an API like this:</p>
   <div class="example" id="example-48e6526a">
    <a class="self-link" href="#example-48e6526a"></a> 
<pre class="idl highlight def">[<c- g>Exposed</c->=<c- n>Window</c->,<c- g>DedicatedWorker</c->]
<c- b>interface</c-> <c- g>MediaStreamTrackGenerator</c-> : <c- n>MediaStreamTrack</c-> {
    <c- g>constructor</c->(<c- n>MediaStreamTrackGeneratorInit</c-> <c- g>init</c->);
    <c- b>attribute</c-> <c- n>WritableStream</c-> <c- g>writable</c->;  // VideoFrame or AudioData
};

<c- b>dictionary</c-> <c- g>MediaStreamTrackGeneratorInit</c-> {
  <c- b>required</c-> <c- b>DOMString</c-> <c- g>kind</c->;
};
</pre>
   </div>
    This interface had the generator for the MediaStreamTrack being an instance of
a MediaStreamTrack rather than containing one. 
   <p>The VideoTrackGenerator can be shimmed on top of MediaStreamTrackGenerator like this:</p>
<pre class="example" id="example-35f2a4aa"><a class="self-link" href="#example-35f2a4aa"></a>// Not tested, unlikely to work as written!
class VideoTrackGenerator {
  constructor() {
     this.innerGenerator = new MediaStreamTrackGenerator({kind: 'video'});
     this.writable = this.innerGenerator.writable;
     this.track = this.innerGenerator.clone();
  }
  // Missing: shim for setting of the "muted" attribute.
};

</pre>
   <p>Further description of the previous proposals, including considerations involving
processing of audio, can be found in earlier versions of this document.</p>
   <p class="note" role="note"><span class="marker">Note:</span> A link will be placed here pointing to the chrome-96 branch when
we have finished moving repos about.</p>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification. </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a> 
    <p>This is an example of an informative example. </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this: </p>
   <p class="note" role="note">Note, this is an informative note.</p>
   <section>
    <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
    <p>Requirements phrased in the imperative as part of algorithms
    (such as "strip any leading space characters"
    or "return false and abort these steps")
    are to be interpreted with the meaning of the key word
    ("must", "should", "may", etc)
    used in introducing the algorithm. </p>
    <p>Conformance requirements phrased as algorithms or specific steps
    can be implemented in any manner,
    so long as the end result is equivalent.
    In particular, the algorithms defined in this specification
    are intended to be easy to understand
    and are not intended to be performant.
    Implementers are encouraged to optimize. </p>
   </section>
  </div>
<script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#closewritable">closeWritable</a><span>, in § 2.2.4</span>
   <li><a href="#dom-videotrackgenerator-videotrackgenerator">constructor()</a><span>, in § 2.2.3</span>
   <li><a href="#dom-mediastreamtrackprocessor-mediastreamtrackprocessor">constructor(init)</a><span>, in § 2.1.3</span>
   <li><a href="#handlenewframe">handleNewFrame</a><span>, in § 2.1.5</span>
   <li><a href="#dom-mediastreamtrackprocessor-isclosed-slot">[[isClosed]]</a><span>, in § 2.1.2</span>
   <li><a href="#dom-videotrackgenerator-ismuted-slot">[[isMuted]]</a><span>, in § 2.2.2</span>
   <li><a href="#dom-mediastreamtrackprocessor-maxbuffersize-slot">[[maxBufferSize]]</a><span>, in § 2.1.2</span>
   <li><a href="#dom-mediastreamtrackprocessorinit-maxbuffersize">maxBufferSize</a><span>, in § 2.1.1</span>
   <li><a href="#maybereadframe">maybeReadFrame</a><span>, in § 2.1.4</span>
   <li><a href="#mediastreamtrackprocessor">MediaStreamTrackProcessor</a><span>, in § 2.1.1</span>
   <li><a href="#dom-mediastreamtrackprocessor-mediastreamtrackprocessor">MediaStreamTrackProcessor(init)</a><span>, in § 2.1.3</span>
   <li><a href="#dictdef-mediastreamtrackprocessorinit">MediaStreamTrackProcessorInit</a><span>, in § 2.1.1</span>
   <li><a href="#dom-videotrackgenerator-muted">muted</a><span>, in § 2.2.4</span>
   <li><a href="#dom-mediastreamtrackprocessor-numpendingreads-slot">[[numPendingReads]]</a><span>, in § 2.1.2</span>
   <li><a href="#processorcancel">processorCancel</a><span>, in § 2.1.4</span>
   <li><a href="#processorclose">processorClose</a><span>, in § 2.1.4</span>
   <li><a href="#processorpull">processorPull</a><span>, in § 2.1.4</span>
   <li><a href="#dom-mediastreamtrackprocessor-queue-slot">[[queue]]</a><span>, in § 2.1.2</span>
   <li><a href="#dom-mediastreamtrackprocessor-readable">readable</a><span>, in § 2.1.4</span>
   <li>
    [[track]]
    <ul>
     <li><a href="#dom-mediastreamtrackprocessor-track-slot">attribute for MediaStreamTrackProcessor</a><span>, in § 2.1.2</span>
     <li><a href="#dom-videotrackgenerator-track-slot">attribute for VideoTrackGenerator</a><span>, in § 2.2.2</span>
    </ul>
   <li>
    track
    <ul>
     <li><a href="#dom-videotrackgenerator-track">attribute for VideoTrackGenerator</a><span>, in § 2.2.4</span>
     <li><a href="#dom-mediastreamtrackprocessorinit-track">dict-member for MediaStreamTrackProcessorInit</a><span>, in § 2.1.1</span>
    </ul>
   <li><a href="#videotrackgenerator">VideoTrackGenerator</a><span>, in § 2.2.1</span>
   <li><a href="#dom-videotrackgenerator-videotrackgenerator">VideoTrackGenerator()</a><span>, in § 2.2.3</span>
   <li><a href="#dom-videotrackgenerator-writable">writable</a><span>, in § 2.2.4</span>
   <li><a href="#writeframe">writeFrame</a><span>, in § 2.2.4</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[CSS-TEXT-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="c1f9d7c8">tracking</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="9db69224">[[Detached]]</span>
     <li><span class="dfn-paneled" id="9a517a7d">queue a task</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="9a9b558b">dequeue</span>
     <li><span class="dfn-paneled" id="03afaf9c">empty</span>
     <li><span class="dfn-paneled" id="06a6db54">enqueue</span>
     <li><span class="dfn-paneled" id="47dfca75">queue</span>
     <li><span class="dfn-paneled" id="99c988d6">remove</span>
    </ul>
   <li>
    <a data-link-type="biblio">[MEDIACAPTURE-STREAMS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="ac7e1700">ConstrainDOMString</span>
     <li><span class="dfn-paneled" id="d198edfa">ConstrainDouble</span>
     <li><span class="dfn-paneled" id="49c01d9b">ConstrainULong</span>
     <li><span class="dfn-paneled" id="bc1e4fa1">MediaStreamTrack</span>
     <li><span class="dfn-paneled" id="83b77d97">OverconstrainedError</span>
     <li><span class="dfn-paneled" id="0c4f8f40">VideoResizeModeEnum</span>
     <li><span class="dfn-paneled" id="e787fb10">applyConstraints()</span>
     <li><span class="dfn-paneled" id="4c67807e">clone()</span>
     <li><span class="dfn-paneled" id="3e23ac7c">create a MediaStreamTrack</span>
     <li><span class="dfn-paneled" id="f4e7a51f">crop-and-scale</span>
     <li><span class="dfn-paneled" id="377e6e47">getCapabilities()</span>
     <li><span class="dfn-paneled" id="2cf6d842">muted</span>
     <li><span class="dfn-paneled" id="11cb734a">none</span>
     <li><span class="dfn-paneled" id="c26e55a2">set a track's muted state</span>
     <li><span class="dfn-paneled" id="0540742f">stop()</span>
    </ul>
   <li>
    <a data-link-type="biblio">[STREAMS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="59ed4e57">ReadableStream</span>
     <li><span class="dfn-paneled" id="c177e2d6">ReadableStreamDefaultControllerClose</span>
     <li><span class="dfn-paneled" id="59dc45b5">WritableStream</span>
     <li><span class="dfn-paneled" id="b5a689f5">[[controller]]</span>
     <li><span class="dfn-paneled" id="22429d52">abortalgorithm</span>
     <li><span class="dfn-paneled" id="b5b30abb">cancelalgorithm</span>
     <li><span class="dfn-paneled" id="04dc6c33">closealgorithm</span>
     <li><span class="dfn-paneled" id="826fa069">closing</span>
     <li><span class="dfn-paneled" id="6b6bb798">enqueue</span>
     <li><span class="dfn-paneled" id="e2b69bfa">highwatermark</span>
     <li><span class="dfn-paneled" id="42f97769">pullalgorithm</span>
     <li><span class="dfn-paneled" id="d438bc09">set up <small>(for ReadableStream)</small></span>
     <li><span class="dfn-paneled" id="3dc81766">set up <small>(for WritableStream)</small></span>
     <li><span class="dfn-paneled" id="d04a8309">writealgorithm</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBCODECS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="5d42f776">VideoEncoder</span>
     <li><span class="dfn-paneled" id="b2005642">VideoFrame</span>
     <li><span class="dfn-paneled" id="7902d763">clone videoframe</span>
     <li><span class="dfn-paneled" id="30f17531">close videoframe</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="c01cbda0">EnforceRange</span>
     <li><span class="dfn-paneled" id="889e932f">Exposed</span>
     <li><span class="dfn-paneled" id="82ca3efc">TypeError</span>
     <li><span class="dfn-paneled" id="d0b4a948">a promise rejected with</span>
     <li><span class="dfn-paneled" id="8f5c2179">a promise resolved with</span>
     <li><span class="dfn-paneled" id="5372cca8">boolean</span>
     <li><span class="dfn-paneled" id="4013a022">this</span>
     <li><span class="dfn-paneled" id="450958f7">unsigned short</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBRTC]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="7c983b6d">RTCPeerConnection</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-css-text-4">[CSS-TEXT-4]
   <dd>Elika Etemad; et al. <a href="https://drafts.csswg.org/css-text-4/"><cite>CSS Text Module Level 4</cite></a>. URL: <a href="https://drafts.csswg.org/css-text-4/">https://drafts.csswg.org/css-text-4/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-mediacapture-streams">[MEDIACAPTURE-STREAMS]
   <dd>Cullen Jennings; et al. <a href="https://w3c.github.io/mediacapture-main/"><cite>Media Capture and Streams</cite></a>. URL: <a href="https://w3c.github.io/mediacapture-main/">https://w3c.github.io/mediacapture-main/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-streams">[STREAMS]
   <dd>Adam Rice; et al. <a href="https://streams.spec.whatwg.org/"><cite>Streams Standard</cite></a>. Living Standard. URL: <a href="https://streams.spec.whatwg.org/">https://streams.spec.whatwg.org/</a>
   <dt id="biblio-webcodecs">[WEBCODECS]
   <dd>Paul Adenot; Bernard Aboba; Eugene Zemtsov. <a href="https://w3c.github.io/webcodecs/"><cite>WebCodecs</cite></a>. URL: <a href="https://w3c.github.io/webcodecs/">https://w3c.github.io/webcodecs/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
   <dt id="biblio-webrtc">[WEBRTC]
   <dd>Cullen Jennings; et al. <a href="https://w3c.github.io/webrtc-pc/"><cite>WebRTC: Real-Time Communication in Browsers</cite></a>. URL: <a href="https://w3c.github.io/webrtc-pc/">https://w3c.github.io/webrtc-pc/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-screen-capture">[SCREEN-CAPTURE]
   <dd>Jan-Ivar Bruaroey; Elad Alon. <a href="https://w3c.github.io/mediacapture-screen-share/"><cite>Screen Capture</cite></a>. URL: <a href="https://w3c.github.io/mediacapture-screen-share/">https://w3c.github.io/mediacapture-screen-share/</a>
   <dt id="biblio-webrtc-nv-use-cases">[WEBRTC-NV-USE-CASES]
   <dd>Bernard Aboba. <a href="https://w3c.github.io/webrtc-nv-use-cases/"><cite>WebRTC Extended Use Cases</cite></a>. URL: <a href="https://w3c.github.io/webrtc-nv-use-cases/">https://w3c.github.io/webrtc-nv-use-cases/</a>
   <dt id="biblio-webtransport">[WEBTRANSPORT]
   <dd>Bernard Aboba; Nidhi Jaju; Victor Vasiliev. <a href="https://w3c.github.io/webtransport/"><cite>WebTransport</cite></a>. URL: <a href="https://w3c.github.io/webtransport/">https://w3c.github.io/webtransport/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>DedicatedWorker</c->]
<c- b>interface</c-> <a href="#mediastreamtrackprocessor"><code><c- g>MediaStreamTrackProcessor</c-></code></a> {
    <a class="idl-code" data-link-type="constructor" href="#dom-mediastreamtrackprocessor-mediastreamtrackprocessor"><c- g>constructor</c-></a>(<a data-link-type="idl-name" href="#dictdef-mediastreamtrackprocessorinit"><c- n>MediaStreamTrackProcessorInit</c-></a> <a href="#dom-mediastreamtrackprocessor-mediastreamtrackprocessor-init-init"><code><c- g>init</c-></code></a>);
    <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://streams.spec.whatwg.org/#readablestream"><c- n>ReadableStream</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ReadableStream" href="#dom-mediastreamtrackprocessor-readable"><c- g>readable</c-></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-mediastreamtrackprocessorinit"><code><c- g>MediaStreamTrackProcessorInit</c-></code></a> {
  <c- b>required</c-> <a data-link-type="idl-name" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack"><c- n>MediaStreamTrack</c-></a> <a data-type="MediaStreamTrack " href="#dom-mediastreamtrackprocessorinit-track"><code><c- g>track</c-></code></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange"><c- g>EnforceRange</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short"><c- b>unsigned</c-> <c- b>short</c-></a> <a data-type="unsigned short " href="#dom-mediastreamtrackprocessorinit-maxbuffersize"><code><c- g>maxBufferSize</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>DedicatedWorker</c->]
<c- b>interface</c-> <a href="#videotrackgenerator"><code><c- g>VideoTrackGenerator</c-></code></a> {
  <a class="idl-code" data-link-type="constructor" href="#dom-videotrackgenerator-videotrackgenerator"><c- g>constructor</c-></a>();
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://streams.spec.whatwg.org/#writablestream"><c- n>WritableStream</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="WritableStream" href="#dom-videotrackgenerator-writable"><c- g>writable</c-></a>;
  <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a class="idl-code" data-link-type="attribute" data-type="boolean" href="#dom-videotrackgenerator-muted"><c- g>muted</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack"><c- n>MediaStreamTrack</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="MediaStreamTrack" href="#dom-videotrackgenerator-track"><c- g>track</c-></a>;
};

</pre>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
    const dfnsJson = window.dfnsJson || {};

    function genDfnPanel({dfnID, url, dfnText, refSections, external}) {
        return mk.aside({
            class: "dfn-panel",
            id: `infopanel-for-${dfnID}`,
            "data-for": dfnID,
            "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
            },
            mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
                `Info about the '${dfnText}' ${external?"external":""} reference.`),
            mk.a({href:url}, url),
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({
                                    href: `#${ref.id}`
                                    },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        );
    }

    function genAllDfnPanels() {
        for(const panelData of Object.values(window.dfnpanelData)) {
            const dfnID = panelData.dfnID;
            const dfn = document.getElementById(dfnID);
            if(!dfn) {
                console.log(`Can't find dfn#${dfnID}.`, panelData);
            } else {
                const panel = genDfnPanel(panelData);
                append(document.body, panel);
                insertDfnPopupAction(dfn, panel)
            }
        }
    }

    document.addEventListener("DOMContentLoaded", ()=>{
        genAllDfnPanels();

        // Add popup behavior to all dfns to show the corresponding dfn-panel.
        var dfns = queryAll('.dfn-paneled');
        for(let dfn of dfns) { ; }

        document.body.addEventListener("click", (e) => {
            // If not handled already, just hide all dfn panels.
            hideAllDfnPanels();
        });
    })


    function hideAllDfnPanels() {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>hideDfnPanel(el));
    }

    function showDfnPanel(dfnPanel, dfn) {
        hideAllDfnPanels(); // Only display one at this time.
        dfn.setAttribute("aria-expanded", "true");
        dfnPanel.classList.add("on");
        dfnPanel.style.left = "5px";
        dfnPanel.style.top = "0px";
        const panelRect = dfnPanel.getBoundingClientRect();
        const panelWidth = panelRect.right - panelRect.left;
        if (panelRect.right > document.body.scrollWidth) {
            // Panel's overflowing the screen.
            // Just drop it below the dfn and flip it rightward instead.
            // This still wont' fix things if the screen is *really* wide,
            // but fixing that's a lot harder without 'anchor()'.
            dfnPanel.style.top = "1.5em";
            dfnPanel.style.left = "auto";
            dfnPanel.style.right = "0px";
        }
    }

    function pinDfnPanel(dfnPanel) {
        // Switch it to "activated" state, which pins it.
        dfnPanel.classList.add("activated");
        dfnPanel.style.left = null;
        dfnPanel.style.top = null;
    }

    function hideDfnPanel(dfnPanel, dfn) {
        if(!dfn) {
            dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
        }
        dfn.setAttribute("aria-expanded", "false")
        dfnPanel.classList.remove("on");
        dfnPanel.classList.remove("activated");
    }

    function toggleDfnPanel(dfnPanel, dfn) {
        if(dfnPanel.classList.contains("on")) {
            hideDfnPanel(dfnPanel, dfn);
        } else {
            showDfnPanel(dfnPanel, dfn);
        }
    }

    function insertDfnPopupAction(dfn, dfnPanel) {
        // Find dfn panel
        const panelWrapper = document.createElement('span');
        panelWrapper.appendChild(dfnPanel);
        panelWrapper.style.position = "relative";
        panelWrapper.style.height = "0px";
        dfn.insertAdjacentElement("afterend", panelWrapper);
        dfn.setAttribute('role', 'button');
        dfn.setAttribute('aria-expanded', 'false')
        dfn.tabIndex = 0;
        dfn.classList.add('has-dfn-panel');
        dfn.addEventListener('click', (event) => {
            showDfnPanel(dfnPanel, dfn);
            event.stopPropagation();
        });
        dfn.addEventListener('keypress', (event) => {
            const kc = event.keyCode;
            // 32->Space, 13->Enter
            if(kc == 32 || kc == 13) {
                toggleDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        });

        dfnPanel.addEventListener('click', (event) => {
            if (event.target.nodeName == 'A') {
                pinDfnPanel(dfnPanel);
            }
            event.stopPropagation();
        });

        dfnPanel.addEventListener('keydown', (event) => {
            if(event.keyCode == 27) { // Escape key
                hideDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        })
    }
}
</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
    const dfnsJson = window.dfnsJson || {};

    function genDfnPanel({dfnID, url, dfnText, refSections, external}) {
        return mk.aside({
            class: "dfn-panel",
            id: `infopanel-for-${dfnID}`,
            "data-for": dfnID,
            "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
            },
            mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
                `Info about the '${dfnText}' ${external?"external":""} reference.`),
            mk.a({href:url}, url),
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({
                                    href: `#${ref.id}`
                                    },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        );
    }

    function genAllDfnPanels() {
        for(const panelData of Object.values(window.dfnpanelData)) {
            const dfnID = panelData.dfnID;
            const dfn = document.getElementById(dfnID);
            if(!dfn) {
                console.log(`Can't find dfn#${dfnID}.`, panelData);
            } else {
                const panel = genDfnPanel(panelData);
                append(document.body, panel);
                insertDfnPopupAction(dfn, panel)
            }
        }
    }

    document.addEventListener("DOMContentLoaded", ()=>{
        genAllDfnPanels();

        // Add popup behavior to all dfns to show the corresponding dfn-panel.
        var dfns = queryAll('.dfn-paneled');
        for(let dfn of dfns) { ; }

        document.body.addEventListener("click", (e) => {
            // If not handled already, just hide all dfn panels.
            hideAllDfnPanels();
        });
    })


    function hideAllDfnPanels() {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>hideDfnPanel(el));
    }

    function showDfnPanel(dfnPanel, dfn) {
        hideAllDfnPanels(); // Only display one at this time.
        dfn.setAttribute("aria-expanded", "true");
        dfnPanel.classList.add("on");
        dfnPanel.style.left = "5px";
        dfnPanel.style.top = "0px";
        const panelRect = dfnPanel.getBoundingClientRect();
        const panelWidth = panelRect.right - panelRect.left;
        if (panelRect.right > document.body.scrollWidth) {
            // Panel's overflowing the screen.
            // Just drop it below the dfn and flip it rightward instead.
            // This still wont' fix things if the screen is *really* wide,
            // but fixing that's a lot harder without 'anchor()'.
            dfnPanel.style.top = "1.5em";
            dfnPanel.style.left = "auto";
            dfnPanel.style.right = "0px";
        }
    }

    function pinDfnPanel(dfnPanel) {
        // Switch it to "activated" state, which pins it.
        dfnPanel.classList.add("activated");
        dfnPanel.style.left = null;
        dfnPanel.style.top = null;
    }

    function hideDfnPanel(dfnPanel, dfn) {
        if(!dfn) {
            dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
        }
        dfn.setAttribute("aria-expanded", "false")
        dfnPanel.classList.remove("on");
        dfnPanel.classList.remove("activated");
    }

    function toggleDfnPanel(dfnPanel, dfn) {
        if(dfnPanel.classList.contains("on")) {
            hideDfnPanel(dfnPanel, dfn);
        } else {
            showDfnPanel(dfnPanel, dfn);
        }
    }

    function insertDfnPopupAction(dfn, dfnPanel) {
        // Find dfn panel
        const panelWrapper = document.createElement('span');
        panelWrapper.appendChild(dfnPanel);
        panelWrapper.style.position = "relative";
        panelWrapper.style.height = "0px";
        dfn.insertAdjacentElement("afterend", panelWrapper);
        dfn.setAttribute('role', 'button');
        dfn.setAttribute('aria-expanded', 'false')
        dfn.tabIndex = 0;
        dfn.classList.add('has-dfn-panel');
        dfn.addEventListener('click', (event) => {
            showDfnPanel(dfnPanel, dfn);
            event.stopPropagation();
        });
        dfn.addEventListener('keypress', (event) => {
            const kc = event.keyCode;
            // 32->Space, 13->Enter
            if(kc == 32 || kc == 13) {
                toggleDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        });

        dfnPanel.addEventListener('click', (event) => {
            if (event.target.nodeName == 'A') {
                pinDfnPanel(dfnPanel);
            }
            event.stopPropagation();
        });

        dfnPanel.addEventListener('keydown', (event) => {
            if(event.keyCode == 27) { // Escape key
                hideDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        })
    }
}
</script>
<script>/* Boilerplate: script-dfn-panel-json */
window.dfnpanelData = {};
window.dfnpanelData['c1f9d7c8'] = {"dfnID": "c1f9d7c8", "url": "https://drafts.csswg.org/css-text-4/#tracking", "dfnText": "tracking", "refSections": [{"refs": [{"id": "ref-for-tracking"}], "title": "2.1.5. Handling interaction with the track"}, {"refs": [{"id": "ref-for-tracking\u2460"}], "title": "2.2.4. Attributes"}], "external": true};
window.dfnpanelData['9db69224'] = {"dfnID": "9db69224", "url": "https://html.spec.whatwg.org/multipage/structured-data.html#detached", "dfnText": "[[Detached]]", "refSections": [{"refs": [{"id": "ref-for-detached"}], "title": "2.2.4. Attributes"}], "external": true};
window.dfnpanelData['9a517a7d'] = {"dfnID": "9a517a7d", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task", "dfnText": "queue a task", "refSections": [{"refs": [{"id": "ref-for-queue-a-task"}], "title": "2.1.4. Attributes"}, {"refs": [{"id": "ref-for-queue-a-task\u2460"}], "title": "2.1.5. Handling interaction with the track"}, {"refs": [{"id": "ref-for-queue-a-task\u2461"}, {"id": "ref-for-queue-a-task\u2462"}], "title": "2.2.4. Attributes"}], "external": true};
window.dfnpanelData['9a9b558b'] = {"dfnID": "9a9b558b", "url": "https://infra.spec.whatwg.org/#queue-dequeue", "dfnText": "dequeue", "refSections": [{"refs": [{"id": "ref-for-queue-dequeue"}], "title": "2.1.4. Attributes"}, {"refs": [{"id": "ref-for-queue-dequeue\u2460"}], "title": "2.1.5. Handling interaction with the track"}], "external": true};
window.dfnpanelData['03afaf9c'] = {"dfnID": "03afaf9c", "url": "https://infra.spec.whatwg.org/#list-empty", "dfnText": "empty", "refSections": [{"refs": [{"id": "ref-for-list-empty"}, {"id": "ref-for-list-empty\u2460"}], "title": "2.1.4. Attributes"}], "external": true};
window.dfnpanelData['06a6db54'] = {"dfnID": "06a6db54", "url": "https://infra.spec.whatwg.org/#queue-enqueue", "dfnText": "enqueue", "refSections": [{"refs": [{"id": "ref-for-queue-enqueue"}], "title": "2.1.5. Handling interaction with the track"}], "external": true};
window.dfnpanelData['47dfca75'] = {"dfnID": "47dfca75", "url": "https://infra.spec.whatwg.org/#queue", "dfnText": "queue", "refSections": [{"refs": [{"id": "ref-for-queue"}], "title": "2.1.2. Internal slots"}, {"refs": [{"id": "ref-for-queue\u2460"}], "title": "2.1.3. Constructor"}], "external": true};
window.dfnpanelData['99c988d6'] = {"dfnID": "99c988d6", "url": "https://infra.spec.whatwg.org/#list-remove", "dfnText": "remove", "refSections": [{"refs": [{"id": "ref-for-list-remove"}], "title": "2.1.5. Handling interaction with the track"}], "external": true};
window.dfnpanelData['ac7e1700'] = {"dfnID": "ac7e1700", "url": "https://w3c.github.io/mediacapture-main/#dom-constraindomstring", "dfnText": "ConstrainDOMString", "refSections": [{"refs": [{"id": "ref-for-dom-constraindomstring"}], "title": "2.2.5.2. Constrainable properties"}], "external": true};
window.dfnpanelData['d198edfa'] = {"dfnID": "d198edfa", "url": "https://w3c.github.io/mediacapture-main/#dom-constraindouble", "dfnText": "ConstrainDouble", "refSections": [{"refs": [{"id": "ref-for-dom-constraindouble"}, {"id": "ref-for-dom-constraindouble\u2460"}], "title": "2.2.5.2. Constrainable properties"}], "external": true};
window.dfnpanelData['49c01d9b'] = {"dfnID": "49c01d9b", "url": "https://w3c.github.io/mediacapture-main/#dom-constrainulong", "dfnText": "ConstrainULong", "refSections": [{"refs": [{"id": "ref-for-dom-constrainulong"}, {"id": "ref-for-dom-constrainulong\u2460"}], "title": "2.2.5.2. Constrainable properties"}], "external": true};
window.dfnpanelData['bc1e4fa1'] = {"dfnID": "bc1e4fa1", "url": "https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack", "dfnText": "MediaStreamTrack", "refSections": [{"refs": [{"id": "ref-for-dom-mediastreamtrack"}], "title": "Unnumbered Section"}, {"refs": [{"id": "ref-for-dom-mediastreamtrack\u2460"}], "title": "1. Introduction"}, {"refs": [{"id": "ref-for-dom-mediastreamtrack\u2461"}, {"id": "ref-for-dom-mediastreamtrack\u2462"}], "title": "2. Specification"}, {"refs": [{"id": "ref-for-dom-mediastreamtrack\u2463"}, {"id": "ref-for-dom-mediastreamtrack\u2464"}], "title": "2.1. MediaStreamTrackProcessor"}, {"refs": [{"id": "ref-for-dom-mediastreamtrack\u2465"}], "title": "2.1.1. Interface definition"}, {"refs": [{"id": "ref-for-dom-mediastreamtrack\u2466"}], "title": "2.1.3. Constructor"}, {"refs": [{"id": "ref-for-dom-mediastreamtrack\u2467"}], "title": "2.1.4. Attributes"}, {"refs": [{"id": "ref-for-dom-mediastreamtrack\u2468"}, {"id": "ref-for-dom-mediastreamtrack\u2460\u24ea"}], "title": "2.2. VideoTrackGenerator"}, {"refs": [{"id": "ref-for-dom-mediastreamtrack\u2460\u2460"}], "title": "2.2.1. Interface definition"}, {"refs": [{"id": "ref-for-dom-mediastreamtrack\u2460\u2461"}, {"id": "ref-for-dom-mediastreamtrack\u2460\u2462"}], "title": "2.2.2. Internal slots"}, {"refs": [{"id": "ref-for-dom-mediastreamtrack\u2460\u2463"}], "title": "2.2.3. Constructor"}, {"refs": [{"id": "ref-for-dom-mediastreamtrack\u2460\u2464"}, {"id": "ref-for-dom-mediastreamtrack\u2460\u2465"}], "title": "2.2.4. Attributes"}, {"refs": [{"id": "ref-for-dom-mediastreamtrack\u2460\u2466"}, {"id": "ref-for-dom-mediastreamtrack\u2460\u2467"}], "title": "2.2.5. Specialization of MediaStreamTrack behavior"}, {"refs": [{"id": "ref-for-dom-mediastreamtrack\u2460\u2468"}, {"id": "ref-for-dom-mediastreamtrack\u2461\u24ea"}], "title": "2.2.5.2. Constrainable properties"}, {"refs": [{"id": "ref-for-dom-mediastreamtrack\u2461\u2460"}], "title": "2.2.5.3. Events and attributes"}, {"refs": [{"id": "ref-for-dom-mediastreamtrack\u2461\u2461"}, {"id": "ref-for-dom-mediastreamtrack\u2461\u2462"}], "title": "4.1. Use with multiple consumers"}, {"refs": [{"id": "ref-for-dom-mediastreamtrack\u2461\u2463"}, {"id": "ref-for-dom-mediastreamtrack\u2461\u2464"}, {"id": "ref-for-dom-mediastreamtrack\u2461\u2465"}, {"id": "ref-for-dom-mediastreamtrack\u2461\u2466"}, {"id": "ref-for-dom-mediastreamtrack\u2461\u2467"}, {"id": "ref-for-dom-mediastreamtrack\u2461\u2468"}, {"id": "ref-for-dom-mediastreamtrack\u2462\u24ea"}], "title": "5. Security and Privacy considerations"}], "external": true};
window.dfnpanelData['83b77d97'] = {"dfnID": "83b77d97", "url": "https://w3c.github.io/mediacapture-main/#dom-overconstrainederror", "dfnText": "OverconstrainedError", "refSections": [{"refs": [{"id": "ref-for-dom-overconstrainederror"}], "title": "2.2.5.2. Constrainable properties"}], "external": true};
window.dfnpanelData['0c4f8f40'] = {"dfnID": "0c4f8f40", "url": "https://w3c.github.io/mediacapture-main/#dom-videoresizemodeenum", "dfnText": "VideoResizeModeEnum", "refSections": [{"refs": [{"id": "ref-for-dom-videoresizemodeenum"}], "title": "2.2.5.2. Constrainable properties"}], "external": true};
window.dfnpanelData['e787fb10'] = {"dfnID": "e787fb10", "url": "https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack-applyconstraints", "dfnText": "applyConstraints()", "refSections": [{"refs": [{"id": "ref-for-dom-mediastreamtrack-applyconstraints"}, {"id": "ref-for-dom-mediastreamtrack-applyconstraints\u2460"}], "title": "2.2.5.2. Constrainable properties"}], "external": true};
window.dfnpanelData['4c67807e'] = {"dfnID": "4c67807e", "url": "https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack-clone", "dfnText": "clone()", "refSections": [{"refs": [{"id": "ref-for-dom-mediastreamtrack-clone"}], "title": "2.2. VideoTrackGenerator"}], "external": true};
window.dfnpanelData['3e23ac7c'] = {"dfnID": "3e23ac7c", "url": "https://w3c.github.io/mediacapture-main/#dfn-create-a-mediastreamtrack", "dfnText": "create a MediaStreamTrack", "refSections": [{"refs": [{"id": "ref-for-dfn-create-a-mediastreamtrack"}], "title": "2.2.3. Constructor"}], "external": true};
window.dfnpanelData['f4e7a51f'] = {"dfnID": "f4e7a51f", "url": "https://w3c.github.io/mediacapture-main/#idl-def-VideoResizeModeEnum.right", "dfnText": "crop-and-scale", "refSections": [{"refs": [{"id": "ref-for-idl-def-VideoResizeModeEnum.right"}, {"id": "ref-for-idl-def-VideoResizeModeEnum.right\u2460"}], "title": "2.2.5.2. Constrainable properties"}], "external": true};
window.dfnpanelData['377e6e47'] = {"dfnID": "377e6e47", "url": "https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack-getcapabilities", "dfnText": "getCapabilities()", "refSections": [{"refs": [{"id": "ref-for-dom-mediastreamtrack-getcapabilities"}], "title": "2.2.5.2. Constrainable properties"}], "external": true};
window.dfnpanelData['2cf6d842'] = {"dfnID": "2cf6d842", "url": "https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack-muted", "dfnText": "muted", "refSections": [{"refs": [{"id": "ref-for-dom-mediastreamtrack-muted"}], "title": "2.2.2. Internal slots"}], "external": true};
window.dfnpanelData['11cb734a'] = {"dfnID": "11cb734a", "url": "https://w3c.github.io/mediacapture-main/#idl-def-VideoResizeModeEnum.user", "dfnText": "none", "refSections": [{"refs": [{"id": "ref-for-idl-def-VideoResizeModeEnum.user"}, {"id": "ref-for-idl-def-VideoResizeModeEnum.user\u2460"}], "title": "2.2.5.2. Constrainable properties"}], "external": true};
window.dfnpanelData['c26e55a2'] = {"dfnID": "c26e55a2", "url": "https://w3c.github.io/mediacapture-main/#set-track-muted", "dfnText": "set a track's muted state", "refSections": [{"refs": [{"id": "ref-for-set-track-muted"}], "title": "2.2.4. Attributes"}], "external": true};
window.dfnpanelData['0540742f'] = {"dfnID": "0540742f", "url": "https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack-stop", "dfnText": "stop()", "refSections": [{"refs": [{"id": "ref-for-dom-mediastreamtrack-stop"}], "title": "2.2.5.1. stop"}], "external": true};
window.dfnpanelData['59ed4e57'] = {"dfnID": "59ed4e57", "url": "https://streams.spec.whatwg.org/#readablestream", "dfnText": "ReadableStream", "refSections": [{"refs": [{"id": "ref-for-readablestream"}, {"id": "ref-for-readablestream\u2460"}, {"id": "ref-for-readablestream\u2461"}, {"id": "ref-for-readablestream\u2462"}], "title": "2.1. MediaStreamTrackProcessor"}, {"refs": [{"id": "ref-for-readablestream\u2463"}], "title": "2.1.1. Interface definition"}, {"refs": [{"id": "ref-for-readablestream\u2464"}, {"id": "ref-for-readablestream\u2465"}], "title": "2.1.4. Attributes"}], "external": true};
window.dfnpanelData['c177e2d6'] = {"dfnID": "c177e2d6", "url": "https://streams.spec.whatwg.org/#readable-stream-default-controller-close", "dfnText": "ReadableStreamDefaultControllerClose", "refSections": [{"refs": [{"id": "ref-for-readable-stream-default-controller-close"}], "title": "2.1.4. Attributes"}], "external": true};
window.dfnpanelData['59dc45b5'] = {"dfnID": "59dc45b5", "url": "https://streams.spec.whatwg.org/#writablestream", "dfnText": "WritableStream", "refSections": [{"refs": [{"id": "ref-for-writablestream"}, {"id": "ref-for-writablestream\u2460"}], "title": "2.2. VideoTrackGenerator"}, {"refs": [{"id": "ref-for-writablestream\u2461"}], "title": "2.2.1. Interface definition"}, {"refs": [{"id": "ref-for-writablestream\u2462"}, {"id": "ref-for-writablestream\u2463"}], "title": "2.2.4. Attributes"}], "external": true};
window.dfnpanelData['b5a689f5'] = {"dfnID": "b5a689f5", "url": "https://streams.spec.whatwg.org/#readablestream-controller", "dfnText": "[[controller]]", "refSections": [{"refs": [{"id": "ref-for-readablestream-controller"}], "title": "2.1.4. Attributes"}], "external": true};
window.dfnpanelData['22429d52'] = {"dfnID": "22429d52", "url": "https://streams.spec.whatwg.org/#writablestream-set-up-abortalgorithm", "dfnText": "abortalgorithm", "refSections": [{"refs": [{"id": "ref-for-writablestream-set-up-abortalgorithm"}], "title": "2.2.4. Attributes"}], "external": true};
window.dfnpanelData['b5b30abb'] = {"dfnID": "b5b30abb", "url": "https://streams.spec.whatwg.org/#readablestream-set-up-cancelalgorithm", "dfnText": "cancelalgorithm", "refSections": [{"refs": [{"id": "ref-for-readablestream-set-up-cancelalgorithm"}], "title": "2.1.4. Attributes"}], "external": true};
window.dfnpanelData['04dc6c33'] = {"dfnID": "04dc6c33", "url": "https://streams.spec.whatwg.org/#writablestream-set-up-closealgorithm", "dfnText": "closealgorithm", "refSections": [{"refs": [{"id": "ref-for-writablestream-set-up-closealgorithm"}], "title": "2.2.4. Attributes"}], "external": true};
window.dfnpanelData['826fa069'] = {"dfnID": "826fa069", "url": "https://streams.spec.whatwg.org/#writablestream-close", "dfnText": "closing", "refSections": [{"refs": [{"id": "ref-for-writablestream-close"}], "title": "2.2.5.1. stop"}], "external": true};
window.dfnpanelData['6b6bb798'] = {"dfnID": "6b6bb798", "url": "https://streams.spec.whatwg.org/#readablestream-enqueue", "dfnText": "enqueue", "refSections": [{"refs": [{"id": "ref-for-readablestream-enqueue"}], "title": "2.1.4. Attributes"}], "external": true};
window.dfnpanelData['e2b69bfa'] = {"dfnID": "e2b69bfa", "url": "https://streams.spec.whatwg.org/#readablestream-set-up-highwatermark", "dfnText": "highwatermark", "refSections": [{"refs": [{"id": "ref-for-readablestream-set-up-highwatermark"}], "title": "2.1.4. Attributes"}], "external": true};
window.dfnpanelData['42f97769'] = {"dfnID": "42f97769", "url": "https://streams.spec.whatwg.org/#readablestream-set-up-pullalgorithm", "dfnText": "pullalgorithm", "refSections": [{"refs": [{"id": "ref-for-readablestream-set-up-pullalgorithm"}], "title": "2.1.4. Attributes"}], "external": true};
window.dfnpanelData['d438bc09'] = {"dfnID": "d438bc09", "url": "https://streams.spec.whatwg.org/#readablestream-set-up", "dfnText": "set up (for ReadableStream)", "refSections": [{"refs": [{"id": "ref-for-readablestream-set-up"}], "title": "2.1.4. Attributes"}], "external": true};
window.dfnpanelData['3dc81766'] = {"dfnID": "3dc81766", "url": "https://streams.spec.whatwg.org/#writablestream-set-up", "dfnText": "set up (for WritableStream)", "refSections": [{"refs": [{"id": "ref-for-writablestream-set-up"}], "title": "2.2.4. Attributes"}], "external": true};
window.dfnpanelData['d04a8309'] = {"dfnID": "d04a8309", "url": "https://streams.spec.whatwg.org/#writablestream-set-up-writealgorithm", "dfnText": "writealgorithm", "refSections": [{"refs": [{"id": "ref-for-writablestream-set-up-writealgorithm"}], "title": "2.2.4. Attributes"}], "external": true};
window.dfnpanelData['5d42f776'] = {"dfnID": "5d42f776", "url": "https://w3c.github.io/webcodecs/#videoencoder", "dfnText": "VideoEncoder", "refSections": [{"refs": [{"id": "ref-for-videoencoder"}], "title": "4.1. Use with multiple consumers"}], "external": true};
window.dfnpanelData['b2005642'] = {"dfnID": "b2005642", "url": "https://w3c.github.io/webcodecs/#videoframe", "dfnText": "VideoFrame", "refSections": [{"refs": [{"id": "ref-for-videoframe"}], "title": "2.1. MediaStreamTrackProcessor"}, {"refs": [{"id": "ref-for-videoframe\u2460"}, {"id": "ref-for-videoframe\u2461"}, {"id": "ref-for-videoframe\u2462"}], "title": "2.2. VideoTrackGenerator"}, {"refs": [{"id": "ref-for-videoframe\u2463"}], "title": "2.2.4. Attributes"}, {"refs": [{"id": "ref-for-videoframe\u2464"}, {"id": "ref-for-videoframe\u2465"}, {"id": "ref-for-videoframe\u2466"}, {"id": "ref-for-videoframe\u2467"}, {"id": "ref-for-videoframe\u2468"}, {"id": "ref-for-videoframe\u2460\u24ea"}, {"id": "ref-for-videoframe\u2460\u2460"}], "title": "2.2.5.2. Constrainable properties"}, {"refs": [{"id": "ref-for-videoframe\u2460\u2461"}, {"id": "ref-for-videoframe\u2460\u2462"}, {"id": "ref-for-videoframe\u2460\u2463"}, {"id": "ref-for-videoframe\u2460\u2464"}], "title": "5. Security and Privacy considerations"}], "external": true};
window.dfnpanelData['7902d763'] = {"dfnID": "7902d763", "url": "https://w3c.github.io/webcodecs/#clone-videoframe", "dfnText": "clone videoframe", "refSections": [{"refs": [{"id": "ref-for-clone-videoframe"}], "title": "2.2.4. Attributes"}], "external": true};
window.dfnpanelData['30f17531'] = {"dfnID": "30f17531", "url": "https://w3c.github.io/webcodecs/#close-videoframe", "dfnText": "close videoframe", "refSections": [{"refs": [{"id": "ref-for-close-videoframe"}], "title": "2.1.5. Handling interaction with the track"}, {"refs": [{"id": "ref-for-close-videoframe\u2460"}], "title": "2.2.4. Attributes"}], "external": true};
window.dfnpanelData['c01cbda0'] = {"dfnID": "c01cbda0", "url": "https://webidl.spec.whatwg.org/#EnforceRange", "dfnText": "EnforceRange", "refSections": [{"refs": [{"id": "ref-for-EnforceRange"}], "title": "2.1.1. Interface definition"}], "external": true};
window.dfnpanelData['889e932f'] = {"dfnID": "889e932f", "url": "https://webidl.spec.whatwg.org/#Exposed", "dfnText": "Exposed", "refSections": [{"refs": [{"id": "ref-for-Exposed"}], "title": "2.1.1. Interface definition"}, {"refs": [{"id": "ref-for-Exposed\u2460"}], "title": "2.2.1. Interface definition"}], "external": true};
window.dfnpanelData['82ca3efc'] = {"dfnID": "82ca3efc", "url": "https://webidl.spec.whatwg.org/#exceptiondef-typeerror", "dfnText": "TypeError", "refSections": [{"refs": [{"id": "ref-for-exceptiondef-typeerror"}], "title": "2.1.3. Constructor"}, {"refs": [{"id": "ref-for-exceptiondef-typeerror\u2460"}, {"id": "ref-for-exceptiondef-typeerror\u2461"}], "title": "2.2.4. Attributes"}], "external": true};
window.dfnpanelData['d0b4a948'] = {"dfnID": "d0b4a948", "url": "https://webidl.spec.whatwg.org/#a-promise-rejected-with", "dfnText": "a promise rejected with", "refSections": [{"refs": [{"id": "ref-for-a-promise-rejected-with"}, {"id": "ref-for-a-promise-rejected-with\u2460"}], "title": "2.2.4. Attributes"}], "external": true};
window.dfnpanelData['8f5c2179'] = {"dfnID": "8f5c2179", "url": "https://webidl.spec.whatwg.org/#a-promise-resolved-with", "dfnText": "a promise resolved with", "refSections": [{"refs": [{"id": "ref-for-a-promise-resolved-with"}, {"id": "ref-for-a-promise-resolved-with\u2460"}], "title": "2.1.4. Attributes"}, {"refs": [{"id": "ref-for-a-promise-resolved-with\u2461"}, {"id": "ref-for-a-promise-resolved-with\u2462"}], "title": "2.2.4. Attributes"}], "external": true};
window.dfnpanelData['5372cca8'] = {"dfnID": "5372cca8", "url": "https://webidl.spec.whatwg.org/#idl-boolean", "dfnText": "boolean", "refSections": [{"refs": [{"id": "ref-for-idl-boolean"}], "title": "2.2.1. Interface definition"}, {"refs": [{"id": "ref-for-idl-boolean\u2460"}], "title": "2.2.4. Attributes"}], "external": true};
window.dfnpanelData['4013a022'] = {"dfnID": "4013a022", "url": "https://webidl.spec.whatwg.org/#this", "dfnText": "this", "refSections": [{"refs": [{"id": "ref-for-this"}, {"id": "ref-for-this\u2460"}, {"id": "ref-for-this\u2461"}, {"id": "ref-for-this\u2462"}], "title": "2.1.4. Attributes"}, {"refs": [{"id": "ref-for-this\u2463"}, {"id": "ref-for-this\u2464"}, {"id": "ref-for-this\u2465"}, {"id": "ref-for-this\u2466"}, {"id": "ref-for-this\u2467"}, {"id": "ref-for-this\u2468"}, {"id": "ref-for-this\u2460\u24ea"}, {"id": "ref-for-this\u2460\u2460"}], "title": "2.2.4. Attributes"}], "external": true};
window.dfnpanelData['450958f7'] = {"dfnID": "450958f7", "url": "https://webidl.spec.whatwg.org/#idl-unsigned-short", "dfnText": "unsigned short", "refSections": [{"refs": [{"id": "ref-for-idl-unsigned-short"}], "title": "2.1.1. Interface definition"}], "external": true};
window.dfnpanelData['7c983b6d'] = {"dfnID": "7c983b6d", "url": "https://w3c.github.io/webrtc-pc/#dom-rtcpeerconnection", "dfnText": "RTCPeerConnection", "refSections": [{"refs": [{"id": "ref-for-dom-rtcpeerconnection"}], "title": "1. Introduction"}, {"refs": [{"id": "ref-for-dom-rtcpeerconnection\u2460"}], "title": "4.1. Use with multiple consumers"}], "external": true};
window.dfnpanelData['mediastreamtrackprocessor'] = {"dfnID": "mediastreamtrackprocessor", "url": "#mediastreamtrackprocessor", "dfnText": "MediaStreamTrackProcessor", "refSections": [{"refs": [{"id": "ref-for-mediastreamtrackprocessor"}, {"id": "ref-for-mediastreamtrackprocessor\u2460"}, {"id": "ref-for-mediastreamtrackprocessor\u2461"}, {"id": "ref-for-mediastreamtrackprocessor\u2462"}, {"id": "ref-for-mediastreamtrackprocessor\u2463"}, {"id": "ref-for-mediastreamtrackprocessor\u2464"}, {"id": "ref-for-mediastreamtrackprocessor\u2465"}, {"id": "ref-for-mediastreamtrackprocessor\u2466"}], "title": "2.1. MediaStreamTrackProcessor"}, {"refs": [{"id": "ref-for-mediastreamtrackprocessor\u2467"}, {"id": "ref-for-mediastreamtrackprocessor\u2468"}, {"id": "ref-for-mediastreamtrackprocessor\u2460\u24ea"}], "title": "2.1.2. Internal slots"}, {"refs": [{"id": "ref-for-mediastreamtrackprocessor\u2460\u2460"}], "title": "2.1.3. Constructor"}, {"refs": [{"id": "ref-for-mediastreamtrackprocessor\u2460\u2461"}, {"id": "ref-for-mediastreamtrackprocessor\u2460\u2462"}], "title": "2.1.5. Handling interaction with the track"}, {"refs": [{"id": "ref-for-mediastreamtrackprocessor\u2460\u2463"}], "title": "4.1. Use with multiple consumers"}, {"refs": [{"id": "ref-for-mediastreamtrackprocessor\u2460\u2464"}, {"id": "ref-for-mediastreamtrackprocessor\u2460\u2465"}, {"id": "ref-for-mediastreamtrackprocessor\u2460\u2466"}, {"id": "ref-for-mediastreamtrackprocessor\u2460\u2467"}], "title": "5. Security and Privacy considerations"}], "external": false};
window.dfnpanelData['dictdef-mediastreamtrackprocessorinit'] = {"dfnID": "dictdef-mediastreamtrackprocessorinit", "url": "#dictdef-mediastreamtrackprocessorinit", "dfnText": "MediaStreamTrackProcessorInit", "refSections": [{"refs": [{"id": "ref-for-dictdef-mediastreamtrackprocessorinit"}], "title": "2.1.1. Interface definition"}], "external": false};
window.dfnpanelData['dom-mediastreamtrackprocessorinit-track'] = {"dfnID": "dom-mediastreamtrackprocessorinit-track", "url": "#dom-mediastreamtrackprocessorinit-track", "dfnText": "track", "refSections": [{"refs": [{"id": "ref-for-dom-mediastreamtrackprocessorinit-track"}, {"id": "ref-for-dom-mediastreamtrackprocessorinit-track\u2460"}], "title": "2.1.3. Constructor"}], "external": false};
window.dfnpanelData['dom-mediastreamtrackprocessorinit-maxbuffersize'] = {"dfnID": "dom-mediastreamtrackprocessorinit-maxbuffersize", "url": "#dom-mediastreamtrackprocessorinit-maxbuffersize", "dfnText": "maxBufferSize", "refSections": [{"refs": [{"id": "ref-for-dom-mediastreamtrackprocessorinit-maxbuffersize"}, {"id": "ref-for-dom-mediastreamtrackprocessorinit-maxbuffersize\u2460"}], "title": "2.1.3. Constructor"}], "external": false};
window.dfnpanelData['dom-mediastreamtrackprocessor-mediastreamtrackprocessor'] = {"dfnID": "dom-mediastreamtrackprocessor-mediastreamtrackprocessor", "url": "#dom-mediastreamtrackprocessor-mediastreamtrackprocessor", "dfnText": "\n  MediaStreamTrackProcessor(init)\n", "refSections": [{"refs": [{"id": "ref-for-dom-mediastreamtrackprocessor-mediastreamtrackprocessor"}], "title": "2.1.1. Interface definition"}], "external": false};
window.dfnpanelData['dom-mediastreamtrackprocessor-readable'] = {"dfnID": "dom-mediastreamtrackprocessor-readable", "url": "#dom-mediastreamtrackprocessor-readable", "dfnText": "readable", "refSections": [{"refs": [{"id": "ref-for-dom-mediastreamtrackprocessor-readable"}], "title": "2.1.1. Interface definition"}, {"refs": [{"id": "ref-for-dom-mediastreamtrackprocessor-readable\u2460"}, {"id": "ref-for-dom-mediastreamtrackprocessor-readable\u2461"}, {"id": "ref-for-dom-mediastreamtrackprocessor-readable\u2462"}, {"id": "ref-for-dom-mediastreamtrackprocessor-readable\u2463"}], "title": "2.1.4. Attributes"}, {"refs": [{"id": "ref-for-dom-mediastreamtrackprocessor-readable\u2464"}], "title": "5. Security and Privacy considerations"}], "external": false};
window.dfnpanelData['processorpull'] = {"dfnID": "processorpull", "url": "#processorpull", "dfnText": "processorPull", "refSections": [{"refs": [{"id": "ref-for-processorpull"}], "title": "2.1.4. Attributes"}], "external": false};
window.dfnpanelData['maybereadframe'] = {"dfnID": "maybereadframe", "url": "#maybereadframe", "dfnText": "maybeReadFrame", "refSections": [{"refs": [{"id": "ref-for-maybereadframe"}], "title": "2.1.4. Attributes"}, {"refs": [{"id": "ref-for-maybereadframe\u2460"}], "title": "2.1.5. Handling interaction with the track"}], "external": false};
window.dfnpanelData['processorcancel'] = {"dfnID": "processorcancel", "url": "#processorcancel", "dfnText": "processorCancel", "refSections": [{"refs": [{"id": "ref-for-processorcancel"}], "title": "2.1.4. Attributes"}], "external": false};
window.dfnpanelData['processorclose'] = {"dfnID": "processorclose", "url": "#processorclose", "dfnText": "processorClose", "refSections": [{"refs": [{"id": "ref-for-processorclose"}], "title": "2.1.4. Attributes"}, {"refs": [{"id": "ref-for-processorclose\u2460"}], "title": "2.1.5. Handling interaction with the track"}], "external": false};
window.dfnpanelData['handlenewframe'] = {"dfnID": "handlenewframe", "url": "#handlenewframe", "dfnText": "handleNewFrame", "refSections": [{"refs": [{"id": "ref-for-handlenewframe"}], "title": "2.1.5. Handling interaction with the track"}], "external": false};
window.dfnpanelData['videotrackgenerator'] = {"dfnID": "videotrackgenerator", "url": "#videotrackgenerator", "dfnText": "VideoTrackGenerator", "refSections": [{"refs": [{"id": "ref-for-videotrackgenerator"}, {"id": "ref-for-videotrackgenerator\u2460"}, {"id": "ref-for-videotrackgenerator\u2461"}], "title": "2.2. VideoTrackGenerator"}, {"refs": [{"id": "ref-for-videotrackgenerator\u2462"}], "title": "2.2.3. Constructor"}, {"refs": [{"id": "ref-for-videotrackgenerator\u2463"}, {"id": "ref-for-videotrackgenerator\u2464"}], "title": "2.2.4. Attributes"}, {"refs": [{"id": "ref-for-videotrackgenerator\u2465"}, {"id": "ref-for-videotrackgenerator\u2466"}], "title": "2.2.5. Specialization of MediaStreamTrack behavior"}, {"refs": [{"id": "ref-for-videotrackgenerator\u2467"}, {"id": "ref-for-videotrackgenerator\u2468"}], "title": "2.2.5.1. stop"}, {"refs": [{"id": "ref-for-videotrackgenerator\u2460\u24ea"}, {"id": "ref-for-videotrackgenerator\u2460\u2460"}, {"id": "ref-for-videotrackgenerator\u2460\u2461"}, {"id": "ref-for-videotrackgenerator\u2460\u2462"}, {"id": "ref-for-videotrackgenerator\u2460\u2463"}], "title": "2.2.5.2. Constrainable properties"}, {"refs": [{"id": "ref-for-videotrackgenerator\u2460\u2464"}], "title": "2.2.5.3. Events and attributes"}, {"refs": [{"id": "ref-for-videotrackgenerator\u2460\u2465"}], "title": "4.1. Use with multiple consumers"}, {"refs": [{"id": "ref-for-videotrackgenerator\u2460\u2466"}, {"id": "ref-for-videotrackgenerator\u2460\u2467"}, {"id": "ref-for-videotrackgenerator\u2460\u2468"}, {"id": "ref-for-videotrackgenerator\u2461\u24ea"}, {"id": "ref-for-videotrackgenerator\u2461\u2460"}, {"id": "ref-for-videotrackgenerator\u2461\u2461"}], "title": "5. Security and Privacy considerations"}], "external": false};
window.dfnpanelData['dom-videotrackgenerator-videotrackgenerator'] = {"dfnID": "dom-videotrackgenerator-videotrackgenerator", "url": "#dom-videotrackgenerator-videotrackgenerator", "dfnText": "\n  VideoTrackGenerator()\n", "refSections": [{"refs": [{"id": "ref-for-dom-videotrackgenerator-videotrackgenerator"}], "title": "2.2.1. Interface definition"}], "external": false};
window.dfnpanelData['dom-videotrackgenerator-writable'] = {"dfnID": "dom-videotrackgenerator-writable", "url": "#dom-videotrackgenerator-writable", "dfnText": "writable", "refSections": [{"refs": [{"id": "ref-for-dom-videotrackgenerator-writable"}, {"id": "ref-for-dom-videotrackgenerator-writable\u2460"}, {"id": "ref-for-dom-videotrackgenerator-writable\u2461"}], "title": "2.2. VideoTrackGenerator"}, {"refs": [{"id": "ref-for-dom-videotrackgenerator-writable\u2462"}], "title": "2.2.1. Interface definition"}, {"refs": [{"id": "ref-for-dom-videotrackgenerator-writable\u2463"}, {"id": "ref-for-dom-videotrackgenerator-writable\u2464"}], "title": "2.2.4. Attributes"}, {"refs": [{"id": "ref-for-dom-videotrackgenerator-writable\u2465"}], "title": "2.2.5.1. stop"}, {"refs": [{"id": "ref-for-dom-videotrackgenerator-writable\u2466"}, {"id": "ref-for-dom-videotrackgenerator-writable\u2467"}], "title": "2.2.5.2. Constrainable properties"}, {"refs": [{"id": "ref-for-dom-videotrackgenerator-writable\u2468"}], "title": "2.2.5.3. Events and attributes"}], "external": false};
window.dfnpanelData['writeframe'] = {"dfnID": "writeframe", "url": "#writeframe", "dfnText": "writeFrame", "refSections": [{"refs": [{"id": "ref-for-writeframe"}], "title": "2.2.4. Attributes"}], "external": false};
window.dfnpanelData['closewritable'] = {"dfnID": "closewritable", "url": "#closewritable", "dfnText": "closeWritable", "refSections": [{"refs": [{"id": "ref-for-closewritable"}, {"id": "ref-for-closewritable\u2460"}], "title": "2.2.4. Attributes"}], "external": false};
window.dfnpanelData['dom-videotrackgenerator-muted'] = {"dfnID": "dom-videotrackgenerator-muted", "url": "#dom-videotrackgenerator-muted", "dfnText": "muted", "refSections": [{"refs": [{"id": "ref-for-dom-videotrackgenerator-muted"}], "title": "2.2.1. Interface definition"}], "external": false};
window.dfnpanelData['dom-videotrackgenerator-track'] = {"dfnID": "dom-videotrackgenerator-track", "url": "#dom-videotrackgenerator-track", "dfnText": "track", "refSections": [{"refs": [{"id": "ref-for-dom-videotrackgenerator-track"}, {"id": "ref-for-dom-videotrackgenerator-track\u2460"}, {"id": "ref-for-dom-videotrackgenerator-track\u2461"}], "title": "2.2. VideoTrackGenerator"}, {"refs": [{"id": "ref-for-dom-videotrackgenerator-track\u2462"}], "title": "2.2.1. Interface definition"}, {"refs": [{"id": "ref-for-dom-videotrackgenerator-track\u2463"}], "title": "2.2.3. Constructor"}], "external": false};
</script>
<script>/* Boilerplate: script-dom-helper */
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}
</script>